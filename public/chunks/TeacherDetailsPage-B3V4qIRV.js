import{j as e,V as Ee,z as ce}from"../assets/index-DwMAudUK.js";import{r as g,c as Ae,b as Me,N as $e}from"./vendor-C9PcmKF2.js";import{U as re,g as Y,c as ee,M as pe,d as Le,a as J,O as ne,h as Ie,X as he,Z as _e,a3 as Oe,f as ae,o as Ce,P as xe,S as Fe,b as Pe,B as De,T as ue,e as Z,D as Re,ad as We,aa as ge,ap as ye}from"./ui-CvMS0gwv.js";import{t as He}from"./teacherDetailsApi-C45WQoYF.js";import{a as $,h as q}from"./cascade-deletion-BGRb_82-.js";import{b as fe,a as de,d as Ue,e as me,s as qe,g as Be,h as ze,f as V,i as Xe,j as je,k as Ne,l as Ve}from"./utils-x1PSU_OZ.js";import"./query-BdHdBeoH.js";const ve={personal:{label:"××™×“×¢ ××™×©×™",icon:re},students:{label:"× ×™×”×•×œ ×ª×œ××™×“×™×",icon:Y},schedule:{label:"×œ×•×— ×–×× ×™×",icon:ee},conducting:{label:"× ×™×¦×•×—",icon:pe}},Ye=({activeTab:d,onTabChange:t,tabs:l=[]})=>!l||l.length===0?null:e.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 shadow-sm w-full overflow-hidden teacher-tab-navigation",children:[e.jsx("div",{className:"hidden md:flex w-full overflow-x-auto desktop-tab-nav",children:e.jsx("nav",{className:"flex gap-8 px-6 relative min-w-full","aria-label":"Tabs",children:l.map((i,r)=>{const b=ve[i.id],p=b?.icon||re,C=d===i.id;return e.jsxs("button",{onClick:()=>t(i.id),className:`
                  group inline-flex items-center gap-3 py-4 px-2 border-b-2 font-medium text-sm transition-all duration-300 relative tab-button
                  ${C?"border-primary-500 text-primary-600 bg-primary-50/50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 hover:bg-gray-50/50"}
                `,"aria-current":C?"page":void 0,style:{minHeight:"44px"},children:[e.jsx(p,{className:`w-5 h-5 transition-all duration-300 ${C?"text-primary-500 scale-110":"text-gray-400 group-hover:text-gray-500 group-hover:scale-105"}`}),e.jsx("span",{className:"whitespace-nowrap",children:b?.label||i.label}),C&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-primary-400 to-primary-600 rounded-full animate-scale-in"})]},i.id)})})}),e.jsxs("div",{className:"md:hidden w-full overflow-hidden mobile-tab-nav",children:[e.jsx("div",{className:"overflow-x-auto scrollbar-hide w-full",children:e.jsx("nav",{className:"flex gap-3 px-4 py-3 min-w-max","aria-label":"Tabs",style:{width:"max-content"},children:l.map((i,r)=>{const b=ve[i.id],p=b?.icon||re,C=d===i.id;return e.jsxs("button",{onClick:()=>t(i.id),className:`
                    flex flex-col items-center gap-1 px-4 py-3 rounded-xl font-medium text-xs transition-all duration-300 whitespace-nowrap transform tab-button
                    ${C?"bg-primary-100 text-primary-700 border-2 border-primary-200 scale-105 shadow-md":"text-gray-600 hover:text-gray-900 hover:bg-gray-50 hover:scale-102 border-2 border-transparent"}
                  `,"aria-current":C?"page":void 0,style:{minWidth:"80px",minHeight:"44px"},children:[e.jsx(p,{className:`w-5 h-5 transition-all duration-300 ${C?"text-primary-600":"text-gray-500"}`}),e.jsx("span",{className:"leading-tight",children:b?.label||i.label})]},i.id)})})}),e.jsx("div",{className:"flex justify-center py-1",children:e.jsx("div",{className:"w-8 h-1 bg-gray-200 rounded-full",children:e.jsx("div",{className:"h-full bg-primary-400 rounded-full transition-all duration-300",style:{width:`${l?.length>0?(l.findIndex(i=>i.id===d)+1)/l.length*100:0}%`}})})})]})]}),Ke=({teacher:d,teacherId:t})=>{const[l,i]=g.useState(!1),[r,b]=g.useState(!1),[p,C]=g.useState(null),[T,D]=g.useState(!1),[f,S]=g.useState({}),[E,k]=g.useState({fullName:d.personalInfo?.fullName||"",phone:d.personalInfo?.phone||"",email:d.personalInfo?.email||"",address:d.personalInfo?.address||""}),M=o=>{if(!o)return;const I=o.replace(/[\s\-]/g,"");if(!/^05\d{8}$/.test(I))return"××¡×¤×¨ ×”×˜×œ×¤×•×Ÿ ×‘×¤×•×¨××˜ ×©×’×•×™. ×™×© ×œ×”×–×™×Ÿ ××¡×¤×¨ ×‘×¤×•×¨××˜ 05XXXXXXXX"},L=o=>{if(!o)return;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o))return'×›×ª×•×‘×ª ×”×“×•×"×œ ××™× ×” ×ª×§×™× ×”'},_=o=>{if(!o||o.trim().length===0)return"×™×© ×œ×”×–×™×Ÿ ×©× ××œ×";if(o.trim().length<2)return"×”×©× ×—×™×™×‘ ×œ×”×›×™×œ ×œ×¤×—×•×ª 2 ×ª×•×•×™×"},y=o=>{if(!o||o.trim().length===0)return"×™×© ×œ×”×–×™×Ÿ ×›×ª×•×‘×ª"},v=()=>{const o={fullName:_(E.fullName),phone:M(E.phone),email:L(E.email),address:y(E.address)};return S(o),!Object.values(o).some(I=>I!==void 0)},A=o=>o.replace(/[\s\-]/g,""),W=async()=>{if(v())try{b(!0),C(null),D(!1);const o={...E,phone:A(E.phone)};await He.updateTeacherPersonalInfo(t,o),d.personalInfo.fullName=E.fullName,d.personalInfo.phone=E.phone,d.personalInfo.email=E.email,d.personalInfo.address=E.address,D(!0),i(!1),setTimeout(()=>D(!1),3e3)}catch(o){console.error("Error saving teacher personal info:",o),C(o.message||"×©×’×™××” ×‘×©××™×¨×ª ×”× ×ª×•× ×™×")}finally{b(!1)}},x=()=>{k({fullName:d.personalInfo?.fullName||"",phone:d.personalInfo?.phone||"",email:d.personalInfo?.email||"",address:d.personalInfo?.address||""}),C(null),S({}),i(!1)};return e.jsxs("div",{className:"p-6 space-y-6",children:[T&&e.jsxs("div",{className:"flex items-center gap-2 p-4 bg-green-50 border border-green-200 rounded-lg text-green-800",children:[e.jsx(Le,{className:"w-5 h-5"}),e.jsx("span",{children:"×”× ×ª×•× ×™× × ×©××¨×• ×‘×”×¦×œ×—×”!"})]}),p&&e.jsxs("div",{className:"flex items-center gap-2 p-4 bg-red-50 border border-red-200 rounded-lg text-red-800",children:[e.jsx(J,{className:"w-5 h-5"}),e.jsx("span",{children:p})]}),e.jsx("div",{className:"flex justify-end",children:l?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:W,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"×©×•××¨..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ie,{className:"w-4 h-4"}),"×©××•×¨"]})}),e.jsxs("button",{onClick:x,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(he,{className:"w-4 h-4"}),"×‘×˜×œ"]})]}):e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(ne,{className:"w-4 h-4"}),"×¢×¨×•×š"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-700 border-b pb-2",children:"×¤×¨×˜×™× ×‘×¡×™×¡×™×™×"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(re,{className:"w-4 h-4"}),"×©× ××œ×"]}),l?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",value:E.fullName,onChange:o=>{k({...E,fullName:o.target.value}),f.fullName&&S({...f,fullName:_(o.target.value)})},className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${f.fullName?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-primary-500"}`,placeholder:"×”×›× ×¡ ×©× ××œ×"}),f.fullName&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(J,{className:"w-3 h-3"}),f.fullName]})]}):e.jsx("p",{className:"text-gray-900",children:d.personalInfo?.fullName||"×œ× ×¦×•×™×Ÿ"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(_e,{className:"w-4 h-4"}),"×˜×œ×¤×•×Ÿ"]}),l?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"tel",value:E.phone,onChange:o=>{k({...E,phone:o.target.value}),f.phone&&S({...f,phone:M(o.target.value)})},className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${f.phone?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-primary-500"}`,placeholder:"05XXXXXXXX"}),f.phone&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(J,{className:"w-3 h-3"}),f.phone]})]}):e.jsx("p",{className:"text-gray-900",children:d.personalInfo?.phone||"×œ× ×¦×•×™×Ÿ"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(Oe,{className:"w-4 h-4"}),'×“×•×"×œ']}),l?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"email",value:E.email,onChange:o=>{k({...E,email:o.target.value}),f.email&&S({...f,email:L(o.target.value)})},className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${f.email?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-primary-500"}`,placeholder:"example@email.com"}),f.email&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(J,{className:"w-3 h-3"}),f.email]})]}):e.jsx("p",{className:"text-gray-900",children:d.personalInfo?.email||"×œ× ×¦×•×™×Ÿ"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(ae,{className:"w-4 h-4"}),"×›×ª×•×‘×ª"]}),l?e.jsxs(e.Fragment,{children:[e.jsx("textarea",{value:E.address,onChange:o=>{k({...E,address:o.target.value}),f.address&&S({...f,address:y(o.target.value)})},className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${f.address?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-primary-500"}`,placeholder:"×”×›× ×¡ ×›×ª×•×‘×ª ××’×•×¨×™×",rows:2}),f.address&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(J,{className:"w-3 h-3"}),f.address]})]}):e.jsx("p",{className:"text-gray-900",children:d.personalInfo?.address||"×œ× ×¦×•×™×Ÿ"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-700 border-b pb-2",children:"××™×“×¢ ××§×¦×•×¢×™"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(Ce,{className:"w-4 h-4"}),"×›×œ×™ × ×’×™× ×”"]}),e.jsx("p",{className:"text-gray-900",children:d.professionalInfo?.instrument||"×œ× ×¦×•×™×Ÿ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"×ª×¤×§×™×“×™×"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.roles?.map((o,I)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:o},I))||e.jsx("span",{className:"text-gray-500",children:"××™×Ÿ ×ª×¤×§×™×“×™×"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"×¡×˜×˜×•×¡"}),e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${d.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:d.isActive?"×¤×¢×™×œ":"×œ× ×¤×¢×™×œ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(ee,{className:"w-4 h-4"}),"×ª××¨×™×š ×”×¦×˜×¨×¤×•×ª"]}),e.jsx("p",{className:"text-gray-900",children:d.createdAt?new Date(d.createdAt).toLocaleDateString("he-IL"):"×œ× ×™×“×•×¢"})]}),d.credentials?.lastLogin&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"×›× ×™×¡×” ××—×¨×•× ×”"}),e.jsx("p",{className:"text-gray-900",children:new Date(d.credentials.lastLogin).toLocaleDateString("he-IL")})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3",children:"×¡×™×›×•× ×ª×œ××™×“×™×"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-600",children:d.teaching?.studentIds?.length||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"×¡×š ×”×ª×œ××™×“×™×"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:d.teaching?.timeBlocks?.length||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"×‘×œ×•×§×™ ×–××Ÿ"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Math.round((d.teaching?.timeBlocks?.reduce((o,I)=>o+(I.totalDuration||0),0)||0)/60)}),e.jsx("div",{className:"text-sm text-gray-600",children:"×©×¢×•×ª ×©×‘×•×¢×™×•×ª"})]})]})]})]})},Qe=({teacher:d,teacherId:t})=>{const[l,i]=g.useState([]),[r,b]=g.useState({}),[p,C]=g.useState([]),[T,D]=g.useState(!0),[f,S]=g.useState(!1),[E,k]=g.useState(""),[M,L]=g.useState(""),[_,y]=g.useState(!1),[v,A]=g.useState(-1),[W,x]=g.useState(!1),[o,I]=g.useState(null),[H,U]=g.useState({day:"",startTime:"",duration:30}),K=g.useRef(null),X=g.useRef(null);g.useEffect(()=>{(async()=>{try{D(!0),console.log("ğŸ“š StudentManagementTab - Fetching students for teacher:",{teacherId:t,teacherName:d.personalInfo?.fullName,studentIds:d.teaching?.studentIds});const j=d.teaching?.studentIds||[];if(j.length>0){const F=j.map(R=>$.students.getStudentById(R).catch(z=>(console.warn(`âš ï¸ Failed to fetch student ${R}:`,z.message),null))),N=(await Promise.all(F)).filter(Boolean);console.log("âœ… StudentManagementTab - Fetched students:",N.length),i(N);const B={};N.forEach(R=>{const z=R.teacherAssignments?.some(P=>P.teacherId===t&&P.isActive===!0);B[R._id]=z||!1}),b(B)}else console.log("âš ï¸ StudentManagementTab - No students in teacher.teaching.studentIds"),i([]);const O=await $.students.getStudents();C(O)}catch(j){console.error("âŒ Error fetching students:",j)}finally{D(!1)}})()},[t,d.teaching?.studentIds]);const Q=a=>{k(a._id),L(a.personalInfo?.fullName||""),y(!1),A(-1)},le=a=>{L(a),k(""),y(!0),A(-1)},G=()=>{L(""),k(""),y(!1),A(-1),X.current?.focus()},ie=a=>{if(!_&&(a.key==="ArrowDown"||a.key==="Enter")){y(!0);return}switch(a.key){case"ArrowDown":a.preventDefault(),A(j=>j<n.length-1?j+1:0);break;case"ArrowUp":a.preventDefault(),A(j=>j>0?j-1:n.length-1);break;case"Enter":a.preventDefault(),v>=0&&n[v]&&Q(n[v]);break;case"Escape":y(!1),A(-1),X.current?.blur();break}},se=async()=>{if(E)try{await $.teachers.addStudentToTeacher(t,E);const a=await $.students.getStudentById(E);i(j=>[...j,a]),S(!1),k(""),L("")}catch(a){console.error("Error adding student:",a)}},h=async a=>{const O=l.find(w=>w._id===a)?.personalInfo?.fullName||"×”×ª×œ××™×“",F=d.personalInfo?.fullName||"×”××•×¨×”";if(confirm(`×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ×”×¡×™×¨ ××ª ${O} ××¨×©×™××ª ×”×ª×œ××™×“×™× ×©×œ ${F}?

×¤×¢×•×œ×” ×–×• ×ª× ×ª×§ ××ª ×”×§×©×¨ ×‘×™×Ÿ ×”×ª×œ××™×“ ×œ××•×¨×” ××š ×œ× ×ª××—×§ ××ª ×¤×¨×˜×™ ×”×ª×œ××™×“ ××”××¢×¨×›×ª.`))try{await $.teachers.removeStudentFromTeacher(t,a),i(w=>w.filter(N=>N._id!==a))}catch(w){console.error("Error removing student:",w)}},s=a=>{I(a),x(!0),U({day:"",startTime:"",duration:30})},c=async()=>{if(!o||!H.day||!H.startTime){alert("×× × ××œ× ××ª ×›×œ ×”×©×“×•×ª ×”× ×“×¨×©×™×");return}try{console.log("ğŸ”„ Creating lesson for student:",o.personalInfo?.fullName);const a=(R,z)=>{const[P,oe]=R.split(":").map(Number),te=P*60+oe+z,be=Math.floor(te/60),ke=te%60;return`${be.toString().padStart(2,"0")}:${ke.toString().padStart(2,"0")}`},j=await $.students.getStudentById(o._id);console.log("ğŸ“‹ Current student data loaded:",j.personalInfo?.fullName);const O=j.academicInfo?.instrumentProgress?.find(R=>R.isPrimary)?.instrumentName||"×›×œ×™ × ×’×™× ×”",F={teacherId:t,day:H.day,time:H.startTime,duration:H.duration,location:"",isActive:!0},w=[...j.teacherAssignments||[],F];console.log("ğŸ“¤ Adding new teacher assignment:",F),console.log("ğŸ“ All assignments to be saved:",w);const N={teacherAssignments:w};console.log("ğŸ“¤ Sending update data:",N);const B=await $.students.updateStudent(o._id,N);console.log("âœ… Student updated with new lesson assignment"),b(R=>({...R,[o._id]:!0})),x(!1),I(null),U({day:"",startTime:"",duration:30})}catch(a){console.error("âŒ Failed to schedule lesson:",a);let j="×©×’×™××” ×‘×§×‘×™×¢×ª ×”×©×™×¢×•×¨. ×× × × ×¡×” ×©×•×‘.";a.message.includes("Authentication failed")?j="×¤×’ ×ª×•×§×£ ×”×¤× ×™×™×”. ×× × ×”×ª×—×‘×¨ ××—×“×©.":a.message.includes("validation")?j="×©×’×™××” ×‘× ×ª×•× ×™× ×©×”×•×–× ×•. ×× × ×‘×“×•×§ ××ª ×¤×¨×˜×™ ×”×©×™×¢×•×¨.":a.message.includes("not found")?j="×”×ª×œ××™×“ ×œ× × ××¦× ×‘××¢×¨×›×ª.":a.message.includes("Network")?j="×©×’×™××ª ×¨×©×ª. ×× × ×‘×“×•×§ ××ª ×”×—×™×‘×•×¨ ×œ××™× ×˜×¨× ×˜.":a.message.includes("×©×’×™××” ×‘×©××™×¨×ª ×”× ×ª×•× ×™×")&&(j="×©×’×™××” ×‘×©××™×¨×ª ×”× ×ª×•× ×™× ×‘××¡×“ ×”× ×ª×•× ×™×. ×× × × ×¡×” ×©×•×‘."),alert(j),console.error("Error details:",{message:a.message,stack:a.stack,studentId:o._id,teacherId:t,lessonData:H})}},u=l.map(a=>a._id),n=p.filter(a=>!u.includes(a._id)).filter(a=>{const j=a.personalInfo?.fullName||"",O=a.academicInfo?.class||"",F=M.toLowerCase();return j.toLowerCase().includes(F)||O.toLowerCase().includes(F)});return g.useEffect(()=>{const a=j=>{K.current&&!K.current.contains(j.target)&&(y(!1),A(-1))};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]),g.useEffect(()=>{f||(L(""),k(""),y(!1),A(-1))},[f]),T?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse w-1/3"}),e.jsx("div",{className:"space-y-3",children:[1,2,3].map(a=>e.jsx("div",{className:"h-16 bg-gray-200 rounded animate-pulse"},a))})]}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-all shadow-sm font-medium",children:[e.jsx(xe,{className:"w-4 h-4"}),"×”×•×¡×£ ×ª×œ××™×“"]})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 teacher-modal-backdrop",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-md transform transition-all teacher-modal-container",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6 text-center",children:"×”×•×¡×£ ×ª×œ××™×“ ×—×“×©"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 teacher-modal-label",children:"×—×¤×© ×•×‘×—×¨ ×ª×œ××™×“"}),e.jsx("div",{className:"text-xs text-gray-500",children:"â†‘â†“ ×œ× ×™×•×•×˜ â€¢ Enter ×œ×‘×—×™×¨×” â€¢ Esc ×œ×¡×’×™×¨×”"})]}),e.jsxs("div",{className:"relative",ref:K,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e.jsx(Fe,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{ref:X,type:"text",value:M,onChange:a=>le(a.target.value),onKeyDown:ie,onFocus:()=>y(!0),placeholder:"×”×§×œ×“ ×©× ×ª×œ××™×“ ××• ×›×™×ª×”...",className:"w-full pr-10 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-gray-900 bg-white teacher-search-input",style:{paddingLeft:"2.5rem"}}),M?e.jsx("button",{onClick:G,className:"absolute inset-y-0 left-0 pl-3 flex items-center hover:bg-gray-50 rounded-r-lg",children:e.jsx(he,{className:"h-4 w-4 text-gray-400 hover:text-gray-600"})}):e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Pe,{className:`h-4 w-4 text-gray-400 transition-transform ${_?"rotate-180":""}`})})]}),_&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto teacher-search-dropdown teacher-dropdown-enter",children:n.length>0?e.jsx(e.Fragment,{children:n.map((a,j)=>e.jsx("button",{onClick:()=>Q(a),className:`w-full text-right px-4 py-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0 teacher-search-option ${j===v?"bg-primary-50 text-primary-700 highlighted":"text-gray-900"} ${E===a._id?"bg-primary-100 text-primary-700 font-medium":""}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:a.personalInfo?.fullName}),e.jsxs("span",{className:"text-sm text-gray-500",children:["×›×™×ª×” ",a.academicInfo?.class||"×œ× ×¦×•×™×Ÿ"]})]})},a._id))}):e.jsx("div",{className:"px-4 py-3 text-gray-500 text-center",children:M?"×œ× × ××¦××• ×ª×œ××™×“×™×":"××™×Ÿ ×ª×œ××™×“×™× ×–××™× ×™×"})})]})]}),e.jsxs("div",{className:"flex gap-3 teacher-modal-buttons",children:[e.jsx("button",{onClick:se,disabled:!E,className:"flex-1 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-all disabled:bg-gray-400 disabled:cursor-not-allowed shadow-sm font-medium teacher-modal-button",children:"×”×•×¡×£"}),e.jsx("button",{onClick:()=>{S(!1),k("")},className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all shadow-sm font-medium teacher-modal-button",children:"×‘×˜×œ"})]})]})]})}),W&&o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-md transform transition-all",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6 text-center",children:"×§×‘×™×¢×ª ×©×™×¢×•×¨ ×©×‘×•×¢×™"}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"×¤×¨×˜×™ ×”×ª×œ××™×“"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"×©×:"})," ",o.personalInfo?.fullName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"×›×™×ª×”:"})," ",o.academicInfo?.class||"×œ× ×¦×•×™×Ÿ"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"×›×œ×™ × ×’×™× ×”:"})," ",o.primaryInstrument||"×œ× ×¦×•×™×Ÿ"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×™×•× ×”×©×‘×•×¢"}),e.jsxs("select",{value:H.day,onChange:a=>U(j=>({...j,day:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×™×•×"}),e.jsx("option",{value:"×¨××©×•×Ÿ",children:"×¨××©×•×Ÿ"}),e.jsx("option",{value:"×©× ×™",children:"×©× ×™"}),e.jsx("option",{value:"×©×œ×™×©×™",children:"×©×œ×™×©×™"}),e.jsx("option",{value:"×¨×‘×™×¢×™",children:"×¨×‘×™×¢×™"}),e.jsx("option",{value:"×—××™×©×™",children:"×—××™×©×™"}),e.jsx("option",{value:"×©×™×©×™",children:"×©×™×©×™"}),e.jsx("option",{value:"×©×‘×ª",children:"×©×‘×ª"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×–××Ÿ ×”×ª×—×œ×”"}),e.jsx("input",{type:"time",value:H.startTime,onChange:a=>U(j=>({...j,startTime:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"××©×š (×“×§×•×ª)"}),e.jsxs("select",{value:H.duration,onChange:a=>U(j=>({...j,duration:Number(a.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:30,children:"30 ×“×§×•×ª"}),e.jsx("option",{value:45,children:"45 ×“×§×•×ª"}),e.jsx("option",{value:60,children:"60 ×“×§×•×ª"}),e.jsx("option",{value:90,children:"90 ×“×§×•×ª"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[e.jsx("button",{onClick:c,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:"×§×‘×¢ ×©×™×¢×•×¨"}),e.jsx("button",{onClick:()=>{x(!1),I(null),U({day:"",startTime:"",duration:30})},className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"×‘×™×˜×•×œ"})]})]})]})}),l.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(Y,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"××™×Ÿ ×ª×œ××™×“×™× ××©×•×™×›×™×"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"×¢×“×™×™×Ÿ ×œ× ×©×•×™×›×• ×ª×œ××™×“×™× ×œ××•×¨×” ×–×”"}),e.jsx("button",{onClick:()=>S(!0),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-all shadow-sm font-medium",children:"×”×•×¡×£ ×ª×œ××™×“ ×¨××©×•×Ÿ"})]}):e.jsx("div",{className:"grid gap-4",children:l.map(a=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(re,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:a.personalInfo?.fullName||"×œ×œ× ×©×"}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["×›×™×ª×” ",a.academicInfo?.class||"×œ× ×¦×•×™×Ÿ"]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:a.primaryInstrument||"×œ×œ× ×›×œ×™"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!r[a._id]&&e.jsxs("button",{onClick:()=>s(a),className:"px-3 py-1 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 focus:ring-2 focus:ring-green-500 focus:ring-offset-1 transition-all shadow-sm font-medium flex items-center gap-1",children:[e.jsx(De,{className:"w-4 h-4"}),"×§×‘×¢ ×©×™×¢×•×¨"]}),e.jsx("button",{onClick:()=>window.location.href=`/students/${a._id}`,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 transition-all shadow-sm font-medium",children:"×¦×¤×” ×‘×¤×¨×˜×™×"}),e.jsxs("button",{onClick:()=>h(a._id),className:"px-3 py-1 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 focus:ring-2 focus:ring-red-500 focus:ring-offset-1 transition-all shadow-sm font-medium flex items-center gap-1",children:[e.jsx(ue,{className:"w-4 h-4"}),"×”×¡×¨"]})]})]})},a._id))}),l.length>0&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5"}),"×¡×§×™×¨×ª ×œ×•×— ×–×× ×™×"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.teaching?.timeBlocks?.map((a,j)=>e.jsxs("div",{className:"bg-white rounded-lg p-4 border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:a.day}),e.jsxs("span",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.jsx(Z,{className:"w-4 h-4"}),Math.round(a.totalDuration/60)," ×©×¢×•×ª"]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[a.startTime," - ",a.endTime]}),a.location&&e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["ğŸ“ ",a.location]}),e.jsxs("div",{className:"text-xs text-blue-600 mt-2",children:[a.assignedLessons?.length||0," ×©×™×¢×•×¨×™× ××ª×•×›× × ×™×"]})]},a._id||j))}),(!d.teaching?.timeBlocks||d.teaching.timeBlocks.length===0)&&e.jsx("div",{className:"text-center text-gray-500 py-4",children:"××™×Ÿ ×‘×œ×•×§×™ ×–××Ÿ ××•×’×“×¨×™× ×¢×“×™×™×Ÿ"})]})]})};var Ge={lessThanXSeconds:{one:"×¤×—×•×ª ××©× ×™×™×”",two:"×¤×—×•×ª ××©×ª×™ ×©× ×™×•×ª",other:"×¤×—×•×ª ×Ö¾{{count}} ×©× ×™×•×ª"},xSeconds:{one:"×©× ×™×™×”",two:"×©×ª×™ ×©× ×™×•×ª",other:"{{count}} ×©× ×™×•×ª"},halfAMinute:"×—×¦×™ ×“×§×”",lessThanXMinutes:{one:"×¤×—×•×ª ××“×§×”",two:"×¤×—×•×ª ××©×ª×™ ×“×§×•×ª",other:"×¤×—×•×ª ×Ö¾{{count}} ×“×§×•×ª"},xMinutes:{one:"×“×§×”",two:"×©×ª×™ ×“×§×•×ª",other:"{{count}} ×“×§×•×ª"},aboutXHours:{one:"×›×©×¢×”",two:"×›×©×¢×ª×™×™×",other:"×›Ö¾{{count}} ×©×¢×•×ª"},xHours:{one:"×©×¢×”",two:"×©×¢×ª×™×™×",other:"{{count}} ×©×¢×•×ª"},xDays:{one:"×™×•×",two:"×™×•××™×™×",other:"{{count}} ×™××™×"},aboutXWeeks:{one:"×›×©×‘×•×¢",two:"×›×©×‘×•×¢×™×™×",other:"×›Ö¾{{count}} ×©×‘×•×¢×•×ª"},xWeeks:{one:"×©×‘×•×¢",two:"×©×‘×•×¢×™×™×",other:"{{count}} ×©×‘×•×¢×•×ª"},aboutXMonths:{one:"×›×—×•×“×©",two:"×›×—×•×“×©×™×™×",other:"×›Ö¾{{count}} ×—×•×“×©×™×"},xMonths:{one:"×—×•×“×©",two:"×—×•×“×©×™×™×",other:"{{count}} ×—×•×“×©×™×"},aboutXYears:{one:"×›×©× ×”",two:"×›×©× ×ª×™×™×",other:"×›Ö¾{{count}} ×©× ×™×"},xYears:{one:"×©× ×”",two:"×©× ×ª×™×™×",other:"{{count}} ×©× ×™×"},overXYears:{one:"×™×•×ª×¨ ××©× ×”",two:"×™×•×ª×¨ ××©× ×ª×™×™×",other:"×™×•×ª×¨ ×Ö¾{{count}} ×©× ×™×"},almostXYears:{one:"×›××¢×˜ ×©× ×”",two:"×›××¢×˜ ×©× ×ª×™×™×",other:"×›××¢×˜ {{count}} ×©× ×™×"}},Je=function(t,l,i){if(t==="xDays"&&i!==null&&i!==void 0&&i.addSuffix&&l<=2)return i.comparison&&i.comparison>0?l===1?"××—×¨":"××—×¨×ª×™×™×":l===1?"××ª××•×œ":"×©×œ×©×•×";var r,b=Ge[t];return typeof b=="string"?r=b:l===1?r=b.one:l===2?r=b.two:r=b.other.replace("{{count}}",String(l)),i!=null&&i.addSuffix?i.comparison&&i.comparison>0?"×‘×¢×•×“ "+r:"×œ×¤× ×™ "+r:r},Ze={full:"EEEE, d ×‘MMMM y",long:"d ×‘MMMM y",medium:"d ×‘MMM y",short:"d.M.y"},es={full:"H:mm:ss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},ss={full:"{{date}} '×‘×©×¢×”' {{time}}",long:"{{date}} '×‘×©×¢×”' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ts={date:fe({formats:Ze,defaultWidth:"full"}),time:fe({formats:es,defaultWidth:"full"}),dateTime:fe({formats:ss,defaultWidth:"full"})},as={lastWeek:"eeee '×©×¢×‘×¨ ×‘×©×¢×”' p",yesterday:"'××ª××•×œ ×‘×©×¢×”' p",today:"'×”×™×•× ×‘×©×¢×”' p",tomorrow:"'××—×¨ ×‘×©×¢×”' p",nextWeek:"eeee '×‘×©×¢×”' p",other:"P"},rs=function(t,l,i,r){return as[t]},ns={narrow:["×œ×¤× ×”×´×¡","×œ×¡×¤×™×¨×”"],abbreviated:["×œ×¤× ×”×´×¡","×œ×¡×¤×™×¨×”"],wide:["×œ×¤× ×™ ×”×¡×¤×™×¨×”","×œ×¡×¤×™×¨×”"]},ls={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["×¨×‘×¢×•×Ÿ 1","×¨×‘×¢×•×Ÿ 2","×¨×‘×¢×•×Ÿ 3","×¨×‘×¢×•×Ÿ 4"]},is={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["×™× ×•×³","×¤×‘×¨×³","××¨×¥","××¤×¨×³","×××™","×™×•× ×™","×™×•×œ×™","××•×’×³","×¡×¤×˜×³","××•×§×³","× ×•×‘×³","×“×¦××³"],wide:["×™× ×•××¨","×¤×‘×¨×•××¨","××¨×¥","××¤×¨×™×œ","×××™","×™×•× ×™","×™×•×œ×™","××•×’×•×¡×˜","×¡×¤×˜××‘×¨","××•×§×˜×•×‘×¨","× ×•×‘××‘×¨","×“×¦××‘×¨"]},os={narrow:["××³","×‘×³","×’×³","×“×³","×”×³","×•×³","×©×³"],short:["××³","×‘×³","×’×³","×“×³","×”×³","×•×³","×©×³"],abbreviated:["×™×•× ××³","×™×•× ×‘×³","×™×•× ×’×³","×™×•× ×“×³","×™×•× ×”×³","×™×•× ×•×³","×©×‘×ª"],wide:["×™×•× ×¨××©×•×Ÿ","×™×•× ×©× ×™","×™×•× ×©×œ×™×©×™","×™×•× ×¨×‘×™×¢×™","×™×•× ×—××™×©×™","×™×•× ×©×™×©×™","×™×•× ×©×‘×ª"]},cs={narrow:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×•×§×¨",afternoon:"××—×¨ ×”×¦×”×¨×™×™×",evening:"×¢×¨×‘",night:"×œ×™×œ×”"},abbreviated:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×•×§×¨",afternoon:"××—×¨ ×”×¦×”×¨×™×™×",evening:"×¢×¨×‘",night:"×œ×™×œ×”"},wide:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×•×§×¨",afternoon:"××—×¨ ×”×¦×”×¨×™×™×",evening:"×¢×¨×‘",night:"×œ×™×œ×”"}},ds={narrow:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×‘×•×§×¨",afternoon:"×‘×¦×”×¨×™×™×",evening:"×‘×¢×¨×‘",night:"×‘×œ×™×œ×”"},abbreviated:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×‘×•×§×¨",afternoon:"××—×¨ ×”×¦×”×¨×™×™×",evening:"×‘×¢×¨×‘",night:"×‘×œ×™×œ×”"},wide:{am:"×œ×¤× ×”×´×¦",pm:"××—×”×´×¦",midnight:"×—×¦×•×ª",noon:"×¦×”×¨×™×™×",morning:"×‘×‘×•×§×¨",afternoon:"××—×¨ ×”×¦×”×¨×™×™×",evening:"×‘×¢×¨×‘",night:"×‘×œ×™×œ×”"}},ms=function(t,l){var i=Number(t);if(i<=0||i>10)return String(i);var r=String(l?.unit),b=["year","hour","minute","second"].indexOf(r)>=0,p=["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™","×©×‘×™×¢×™","×©××™× ×™","×ª×©×™×¢×™","×¢×©×™×¨×™"],C=["×¨××©×•× ×”","×©× ×™×™×”","×©×œ×™×©×™×ª","×¨×‘×™×¢×™×ª","×—××™×©×™×ª","×©×™×©×™×ª","×©×‘×™×¢×™×ª","×©××™× ×™×ª","×ª×©×™×¢×™×ª","×¢×©×™×¨×™×ª"],T=i-1;return b?C[T]:p[T]},us={ordinalNumber:ms,era:de({values:ns,defaultWidth:"wide"}),quarter:de({values:ls,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:de({values:is,defaultWidth:"wide"}),day:de({values:os,defaultWidth:"wide"}),dayPeriod:de({values:cs,defaultWidth:"wide",formattingValues:ds,defaultFormattingWidth:"wide"})},xs=/^(\d+|(×¨××©×•×Ÿ|×©× ×™|×©×œ×™×©×™|×¨×‘×™×¢×™|×—××™×©×™|×©×™×©×™|×©×‘×™×¢×™|×©××™× ×™|×ª×©×™×¢×™|×¢×©×™×¨×™|×¨××©×•× ×”|×©× ×™×™×”|×©×œ×™×©×™×ª|×¨×‘×™×¢×™×ª|×—××™×©×™×ª|×©×™×©×™×ª|×©×‘×™×¢×™×ª|×©××™× ×™×ª|×ª×©×™×¢×™×ª|×¢×©×™×¨×™×ª))/i,hs=/^(\d+|×¨×|×©× |×©×œ|×¨×‘|×—|×©×™|×©×‘|×©×|×ª|×¢)/i,gs={narrow:/^×œ(×¡×¤×™×¨×”|×¤× ×”×´×¡)/i,abbreviated:/^×œ(×¡×¤×™×¨×”|×¤× ×”×´×¡)/i,wide:/^×œ(×¤× ×™ ×”)?×¡×¤×™×¨×”/i},fs={any:[/^×œ×¤/i,/^×œ×¡/i]},ps={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^×¨×‘×¢×•×Ÿ [1234]/i},bs={any:[/1/i,/2/i,/3/i,/4/i]},ys={narrow:/^\d+/i,abbreviated:/^(×™× ×•|×¤×‘×¨|××¨×¥|××¤×¨|×××™|×™×•× ×™|×™×•×œ×™|××•×’|×¡×¤×˜|××•×§|× ×•×‘|×“×¦×)×³?/i,wide:/^(×™× ×•××¨|×¤×‘×¨×•××¨|××¨×¥|××¤×¨×™×œ|×××™|×™×•× ×™|×™×•×œ×™|××•×’×•×¡×˜|×¡×¤×˜××‘×¨|××•×§×˜×•×‘×¨|× ×•×‘××‘×¨|×“×¦××‘×¨)/i},js={narrow:[/^1$/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^7/i,/^8/i,/^9/i,/^10/i,/^11/i,/^12/i],any:[/^×™× /i,/^×¤/i,/^××¨/i,/^××¤/i,/^××/i,/^×™×•× /i,/^×™×•×œ/i,/^××•×’/i,/^×¡/i,/^××•×§/i,/^× /i,/^×“/i]},Ns={narrow:/^[××‘×’×“×”×•×©]×³/i,short:/^[××‘×’×“×”×•×©]×³/i,abbreviated:/^(×©×‘×ª|×™×•× (×|×‘|×’|×“|×”|×•)×³)/i,wide:/^×™×•× (×¨××©×•×Ÿ|×©× ×™|×©×œ×™×©×™|×¨×‘×™×¢×™|×—××™×©×™|×©×™×©×™|×©×‘×ª)/i},vs={abbreviated:[/××³$/i,/×‘×³$/i,/×’×³$/i,/×“×³$/i,/×”×³$/i,/×•×³$/i,/^×©/i],wide:[/×Ÿ$/i,/× ×™$/i,/×œ×™×©×™$/i,/×¢×™$/i,/××™×©×™$/i,/×©×™×©×™$/i,/×ª$/i],any:[/^×/i,/^×‘/i,/^×’/i,/^×“/i,/^×”/i,/^×•/i,/^×©/i]},ws={any:/^(××—×¨ ×”|×‘)?(×—×¦×•×ª|×¦×”×¨×™×™×|×‘×•×§×¨|×¢×¨×‘|×œ×™×œ×”|××—×”×´×¦|×œ×¤× ×”×´×¦)/i},Ts={any:{am:/^×œ×¤/i,pm:/^××—×”/i,midnight:/^×—/i,noon:/^×¦/i,morning:/×‘×•×§×¨/i,afternoon:/×‘×¦|××—×¨/i,evening:/×¢×¨×‘/i,night:/×œ×™×œ×”/i}},Ss=["×¨×","×©× ","×©×œ","×¨×‘","×—","×©×™","×©×‘","×©×","×ª","×¢"],Es={ordinalNumber:Ue({matchPattern:xs,parsePattern:hs,valueCallback:function(t){var l=parseInt(t,10);return isNaN(l)?Ss.indexOf(t)+1:l}}),era:me({matchPatterns:gs,defaultMatchWidth:"wide",parsePatterns:fs,defaultParseWidth:"any"}),quarter:me({matchPatterns:ps,defaultMatchWidth:"wide",parsePatterns:bs,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:me({matchPatterns:ys,defaultMatchWidth:"wide",parsePatterns:js,defaultParseWidth:"any"}),day:me({matchPatterns:Ns,defaultMatchWidth:"wide",parsePatterns:vs,defaultParseWidth:"any"}),dayPeriod:me({matchPatterns:ws,defaultMatchWidth:"any",parsePatterns:Ts,defaultParseWidth:"any"})},we={code:"he",formatDistance:Je,formatLong:ts,formatRelative:rs,localize:us,match:Es,options:{weekStartsOn:0,firstWeekContainsDate:1}};const Is={×¨××©×•×Ÿ:0,×©× ×™:1,×©×œ×™×©×™:2,×¨×‘×™×¢×™:3,×—××™×©×™:4,×©×™×©×™:5,×©×‘×ª:6},Te=["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™","×©×‘×ª"],Cs=({teacher:d,timeBlocks:t=[],lessons:l=[],orchestraActivities:i=[],className:r="",showNavigation:b=!0,onLessonUpdate:p,onLessonDelete:C})=>{const[T,D]=g.useState(new Date),[f,S]=g.useState(null),[E,k]=g.useState(!1),[M,L]=g.useState(!1),[_,y]=g.useState(!1),v=g.useMemo(()=>qe(T,{weekStartsOn:0}),[T]),A=g.useMemo(()=>Be(T,{weekStartsOn:0}),[T]),W=g.useMemo(()=>ze({start:v,end:A}),[v,A]),x=h=>{const s=Is[h];return s===void 0?null:Ne(v,s)},o=g.useMemo(()=>{const h=[];return l.forEach((s,c)=>{const u=x(s.day);if(!u)return;const m=s.startTime||s.time||s.scheduleInfo?.startTime,n=s.duration||s.scheduleInfo?.duration||45,a=s.endTime||s.scheduleInfo?.endTime||se(m,n);if(!m){console.warn("Lesson missing time data:",s);return}h.push({id:`lesson-${s._id||c}`,date:u,startTime:m,endTime:a,title:s.lessonType==="group"?"×©×™×¢×•×¨ ×§×‘×•×¦×ª×™":"×©×™×¢×•×¨ ×¤×¨×˜×™",subtitle:s.studentName||"×ª×œ××™×“",studentName:s.studentName,instrumentName:s.instrumentName||s.instrument?.instrumentName,type:"lesson",location:s.location||s.scheduleInfo?.location,color:s.lessonType==="group"?"bg-green-100 border-green-300 text-green-800":"bg-blue-100 border-blue-300 text-blue-800",details:s})}),i.forEach(s=>{const c=x(s.day);if(c){if(!s.startTime||!s.endTime){console.warn("Orchestra activity missing time data:",s);return}h.push({id:`orchestra-${s._id}`,date:c,startTime:s.startTime,endTime:s.endTime,title:s.name,subtitle:s.type==="orchestra"?"×ª×–××•×¨×ª":"×× ×¡××‘×œ",type:s.type,location:s.location,participants:[`${s.participants||0} × ×’× ×™×`],color:s.type==="orchestra"?"bg-purple-100 border-purple-300 text-purple-800":"bg-green-100 border-green-300 text-green-800",details:s})}}),h.sort((s,c)=>{const u=s.date.getTime()-c.date.getTime();if(u!==0)return u;const m=s.startTime||"00:00",n=c.startTime||"00:00";return m.localeCompare(n)})},[t,l,i,d,v]),I=g.useMemo(()=>{const h={};return W.forEach(s=>{const c=V(s,"yyyy-MM-dd");h[c]=o.filter(u=>Xe(u.date,s))}),h},[o,W]),H=()=>D(h=>Ve(h,7)),U=()=>D(h=>Ne(h,7)),K=()=>D(new Date),X=h=>{switch(h){case"lesson":return e.jsx(re,{className:"w-4 h-4"});case"orchestra":return e.jsx(pe,{className:"w-4 h-4"});case"ensemble":return e.jsx(Y,{className:"w-4 h-4"});default:return e.jsx(De,{className:"w-4 h-4"})}},Q=h=>{h.type==="lesson"&&h.details&&(console.log("ğŸ¯ Opening lesson for editing:",h.details),console.log("ğŸ†” Activity ID:",h.id),console.log("ğŸ“‹ Full activity object:",h),S(h.details))},le=async h=>{if(f){k(!0);try{p&&await p({...f,...h}),S(null)}catch(s){console.error("Error updating lesson:",s),alert("×©×’×™××” ×‘×¢×“×›×•×Ÿ ×”×©×™×¢×•×¨. ×× × × ×¡×” ×©×•×‘.")}finally{k(!1)}}},G=async()=>{if(f){L(!0);try{C&&await C(f),S(null),y(!1)}catch(h){console.error("Error deleting lesson:",h),alert("×©×’×™××” ×‘××—×™×§×ª ×”×©×™×¢×•×¨. ×× × × ×¡×” ×©×•×‘.")}finally{L(!1)}}},ie=(h,s)=>{const[c,u]=h.split(":").map(Number),[m,n]=s.split(":").map(Number),a=c*60+u;return m*60+n-a},se=(h,s)=>{if(!h||!s)return h||"00:00";const[c,u]=h.split(":").map(Number),m=c*60+u+s,n=Math.floor(m/60),a=m%60;return`${n.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`};return e.jsxs("div",{className:`bg-white rounded-lg shadow-sm border border-gray-200 ${r}`,children:[b&&e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:H,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Re,{className:"w-5 h-5"})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["×œ×•×— ×–×× ×™× - ",V(v,"dd/MM",{locale:we})," - ",V(A,"dd/MM/yyyy",{locale:we})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[o.length," ×¤×¢×™×œ×•×™×•×ª ×”×©×‘×•×¢"]})]}),e.jsx("button",{onClick:U,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(We,{className:"w-5 h-5"})})]}),e.jsx("button",{onClick:K,className:"px-3 py-1 text-sm bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"×”×©×‘×•×¢ ×”× ×•×›×—×™"})]})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx("div",{className:"grid grid-cols-7 gap-3",children:W.map((h,s)=>{const c=V(h,"yyyy-MM-dd"),u=I[c]||[],m=je(h);return e.jsxs("div",{className:`border rounded-lg ${m?"border-primary-400 bg-primary-50/30":"border-gray-200 bg-white"}`,children:[e.jsxs("div",{className:`p-3 text-center border-b ${m?"bg-primary-100 text-primary-800 border-primary-200":u.length>0?"bg-blue-50 text-blue-700 border-blue-100":"bg-gray-50 text-gray-600 border-gray-200"}`,children:[e.jsx("div",{className:"font-semibold",children:Te[s]}),e.jsx("div",{className:"text-sm mt-1",children:V(h,"dd/MM")}),u.length>0&&e.jsxs("div",{className:"text-xs mt-1 opacity-75",children:[u.length," ×¤×¢×™×œ×•×™×•×ª"]})]}),e.jsx("div",{className:"p-2 space-y-2 min-h-[400px]",children:u.length===0?e.jsx("div",{className:"text-center text-sm text-gray-400 mt-8",children:"××™×Ÿ ×¤×¢×™×œ×•×™×•×ª"}):u.map(n=>e.jsxs("div",{className:`p-3 rounded-lg border-l-4 ${n.color} shadow-sm hover:shadow-md transition-shadow ${n.type==="lesson"?"cursor-pointer":"cursor-default"}`,onClick:()=>n.type==="lesson"&&Q(n),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[X(n.type),e.jsx("span",{className:"font-semibold text-sm",children:n.title})]}),n.type==="lesson"&&e.jsx(ne,{className:"w-4 h-4 text-gray-400 hover:text-blue-600 transition-colors"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs mb-1",children:[e.jsx(Z,{className:"w-3 h-3"}),e.jsxs("span",{className:"font-medium",children:[n.startTime," - ",n.endTime]})]}),n.subtitle&&e.jsxs("div",{className:"text-xs opacity-90 mb-1",children:[n.type==="lesson"&&n.studentName&&e.jsxs("div",{className:"font-medium",children:["×ª×œ××™×“: ",n.studentName]}),n.type!=="lesson"&&e.jsx("div",{children:n.subtitle})]}),n.type==="lesson"&&n.instrumentName&&e.jsxs("div",{className:"text-xs opacity-75 mb-1",children:["×›×œ×™: ",n.instrumentName]}),n.location&&e.jsxs("div",{className:"flex items-center gap-1 text-xs opacity-75",children:[e.jsx(ae,{className:"w-3 h-3"}),e.jsx("span",{children:n.location})]}),n.participants&&e.jsxs("div",{className:"flex items-center gap-1 text-xs opacity-75 mt-1",children:[e.jsx(Y,{className:"w-3 h-3"}),e.jsx("span",{children:n.participants.join(", ")})]})]},n.id))})]},c)})})}),e.jsx("div",{className:"lg:hidden",children:e.jsx("div",{className:"space-y-4 pb-safe",children:W.map((h,s)=>{const c=V(h,"yyyy-MM-dd"),u=I[c]||[],m=je(h);return e.jsxs("div",{className:`border rounded-lg overflow-hidden ${m?"border-primary-400":"border-gray-200"}`,children:[e.jsx("div",{className:`p-3 font-semibold ${m?"bg-primary-100 text-primary-800":u.length>0?"bg-blue-50 text-blue-700":"bg-gray-50 text-gray-700"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{children:[Te[s]," - ",V(h,"dd/MM")]}),u.length>0&&e.jsxs("span",{className:"text-sm opacity-75",children:[u.length," ×¤×¢×™×œ×•×™×•×ª"]})]})}),e.jsx("div",{className:"p-3",children:u.length===0?e.jsx("div",{className:"text-center text-sm text-gray-400 py-4",children:"××™×Ÿ ×¤×¢×™×œ×•×™×•×ª"}):e.jsx("div",{className:"space-y-2",children:u.map(n=>e.jsxs("div",{className:`p-3 rounded-lg border-l-4 ${n.color} ${n.type==="lesson"?"cursor-pointer active:bg-opacity-80 touch-manipulation select-none":"cursor-default"} transition-all duration-200`,onClick:()=>n.type==="lesson"&&Q(n),onTouchStart:a=>{n.type==="lesson"&&(a.currentTarget.style.transform="scale(0.98)")},onTouchEnd:a=>{n.type==="lesson"&&(a.currentTarget.style.transform="scale(1)")},children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[X(n.type),e.jsx("h4",{className:"font-semibold text-sm",children:n.title})]}),n.type==="lesson"&&e.jsx(ne,{className:"w-4 h-4 text-gray-400 hover:text-blue-600 transition-colors"})]}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-3 h-3"}),e.jsxs("span",{className:"font-medium",children:[n.startTime," - ",n.endTime]})]}),n.type==="lesson"&&n.studentName&&e.jsxs("div",{className:"font-medium",children:["×ª×œ××™×“: ",n.studentName]}),n.instrumentName&&e.jsxs("div",{className:"opacity-75",children:["×›×œ×™: ",n.instrumentName]}),n.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ae,{className:"w-3 h-3"}),e.jsx("span",{children:n.location})]}),n.participants&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"w-3 h-3"}),e.jsx("span",{children:n.participants.join(", ")})]})]})]},n.id))})})]},c)})})}),o.length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"×¡×™×›×•× ×”×©×‘×•×¢"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:o.filter(h=>h.type==="lesson").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"×©×™×¢×•×¨×™×"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:o.filter(h=>h.type==="orchestra").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"×ª×–××•×¨×•×ª"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:o.filter(h=>h.type==="ensemble").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"×× ×¡××‘×œ×™×"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:W.filter(h=>{const s=V(h,"yyyy-MM-dd");return(I[s]||[]).length>0}).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"×™××™× ×¤×¢×™×œ×™×"})]})]})]}),t.length>0&&e.jsxs("div",{className:"mt-6 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ee,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"×™××™ ×œ×™××•×“ - ×–××™× ×•×ª ×œ××¢×¨×›×ª"}),e.jsxs("span",{className:"text-sm text-gray-600 bg-white px-2 py-1 rounded-full",children:[t.length," ×‘×œ×•×§×™ ×–××Ÿ"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(h=>e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200 shadow-sm hover:shadow-md transition-all duration-200",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-bold text-gray-900 text-lg",children:h.day}),h.isActive&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full font-medium",children:"×¤×¢×™×œ"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 mb-2",children:[e.jsx(Z,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"font-medium",children:[h.startTime," - ",h.endTime]})]}),h.location&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-2",children:[e.jsx(ae,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:h.location})]}),h.notes&&e.jsx("div",{className:"text-xs text-gray-500 bg-gray-50 p-2 rounded-md mt-2",children:h.notes})]}),e.jsxs("div",{className:"text-center ml-3",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Math.floor(h.totalDuration/60)}),e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"×©×¢×•×ª"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:h.totalDuration%60!==0&&`+${h.totalDuration%60}×“'`})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:[h.assignedLessons?.length||0," ×©×™×¢×•×¨×™× ××ª×•×›× × ×™×"]}),e.jsx("span",{className:"text-blue-600 font-medium",children:"×–××™×Ÿ ×œ××¢×¨×›×ª"})]})})]},h._id))}),e.jsx("div",{className:"mt-4 p-3 bg-blue-100 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"×”×¡×‘×¨:"})," ×™××™ ×”×œ×™××•×“ ××¦×™×’×™× ××ª ×”×–×× ×™× ×‘×”× ×”××•×¨×” ×–××™×Ÿ ×œ×œ××“. ×¨×§ ×©×™×¢×•×¨×™× ×‘×¤×•×¢×œ ×¢× ×ª×œ××™×“×™× ×•×¤×¢×™×œ×•×™×•×ª ×”× ×™×¦×•×— ××•×¦×’×™× ×‘×œ×•×— ×”×–×× ×™× ×œ××¢×œ×”."]})})]})]}),f&&!_&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"×¢×¨×™×›×ª ×©×™×¢×•×¨ ×¤×¨×˜×™"}),e.jsx("button",{onClick:()=>S(null),className:"text-gray-400 hover:text-gray-600 p-1",children:e.jsx(he,{className:"w-6 h-6"})})]}),e.jsxs("form",{className:"space-y-4",onSubmit:async h=>{h.preventDefault();const s=h.target,c=new FormData(s),u=c.get("day"),m=c.get("startTime"),n=c.get("endTime");if(!u||!m||!n){alert("×× × ××œ× ××ª ×›×œ ×”×©×“×•×ª ×”× ×“×¨×©×™×");return}const a=ie(m,n);if(a<=0){alert("×–××Ÿ ×”×¡×™×•× ×—×™×™×‘ ×œ×”×™×•×ª ×œ××—×¨ ×–××Ÿ ×”×”×ª×—×œ×”");return}await le({day:u,startTime:m,endTime:n,duration:a})},children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×™×•× ×”×©×‘×•×¢"}),e.jsxs("select",{name:"day",defaultValue:f.day,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×™×•×"}),e.jsx("option",{value:"×¨××©×•×Ÿ",children:"×¨××©×•×Ÿ"}),e.jsx("option",{value:"×©× ×™",children:"×©× ×™"}),e.jsx("option",{value:"×©×œ×™×©×™",children:"×©×œ×™×©×™"}),e.jsx("option",{value:"×¨×‘×™×¢×™",children:"×¨×‘×™×¢×™"}),e.jsx("option",{value:"×—××™×©×™",children:"×—××™×©×™"}),e.jsx("option",{value:"×©×™×©×™",children:"×©×™×©×™"}),e.jsx("option",{value:"×©×‘×ª",children:"×©×‘×ª"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×–××Ÿ ×”×ª×—×œ×”"}),e.jsx("input",{type:"time",name:"startTime",defaultValue:f.startTime||f.time,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×–××Ÿ ×¡×™×•×"}),e.jsx("input",{type:"time",name:"endTime",defaultValue:f.endTime||se(f.startTime||f.time||"00:00",f.duration||45),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"×¤×¨×˜×™ ×”×©×™×¢×•×¨"}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"×ª×œ××™×“:"})," ",f.studentName||"×œ× ×¦×•×™×Ÿ"]}),f.instrumentName&&e.jsxs("div",{children:[e.jsx("strong",{children:"×›×œ×™ × ×’×™× ×”:"})," ",f.instrumentName]}),f.location&&e.jsxs("div",{children:[e.jsx("strong",{children:"××™×§×•×:"})," ",f.location]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[e.jsx("button",{type:"submit",disabled:E,className:"flex-1 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-medium disabled:opacity-50",children:E?"×©×•××¨...":"×©××•×¨ ×©×™× ×•×™×™×"}),e.jsx("button",{type:"button",onClick:()=>S(null),className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"×‘×™×˜×•×œ"})]}),C&&e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsxs("button",{type:"button",onClick:()=>y(!0),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-red-50 text-red-700 rounded-lg hover:bg-red-100 transition-colors font-medium border border-red-200",children:[e.jsx(ue,{className:"w-4 h-4"}),"××—×§ ×©×™×¢×•×¨"]})})]})]})}),_&&f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 p-6",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 rounded-full",children:e.jsx(J,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 text-center mb-2",children:"××—×™×§×ª ×©×™×¢×•×¨"}),e.jsx("p",{className:"text-gray-600 text-center mb-2",children:"×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×”×©×™×¢×•×¨ ×©×œ"}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900 text-center mb-4",children:[f.studentName||"×ª×œ××™×“","?"]}),e.jsxs("p",{className:"text-sm text-gray-500 text-center mb-6",children:["×™×•× ",f.day," ×‘×©×¢×” ",f.startTime||f.time]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>y(!1),className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"×‘×™×˜×•×œ"}),e.jsx("button",{onClick:G,disabled:M,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium disabled:opacity-50",children:M?"××•×—×§...":"××—×§"})]})]})})]})};class Ds{async getCurrentOrchestraEnrollments(t){if(!t||t.length===0)return[];try{const l=t.map(async r=>{try{return await q.getOrchestra(r)}catch(b){return console.warn(`Failed to fetch orchestra ${r}:`,b),null}});return(await Promise.allSettled(l)).filter(r=>r.status==="fulfilled"&&r.value!==null).map(r=>r.value)}catch(l){throw console.error("Error fetching orchestra enrollments:",l),{code:"FETCH_ORCHESTRAS_FAILED",message:"×©×’×™××” ×‘×˜×¢×™× ×ª × ×ª×•× ×™ ×”×ª×–××•×¨×•×ª",details:l}}}async getCurrentEnsembleEnrollments(t){if(!t||t.length===0)return[];try{const l=t.map(async r=>{try{return await q.request(`/ensemble/${r}`)}catch(b){return console.warn(`Failed to fetch ensemble ${r}:`,b),null}});return(await Promise.allSettled(l)).filter(r=>r.status==="fulfilled"&&r.value!==null).map(r=>r.value)}catch(l){throw console.error("Error fetching ensemble enrollments:",l),{code:"FETCH_ENSEMBLES_FAILED",message:"×©×’×™××” ×‘×˜×¢×™× ×ª × ×ª×•× ×™ ×”×”×¨×›×‘×™×",details:l}}}async getAllAvailableOrchestras(){try{return(await q.request("/orchestra")).filter(l=>l.isActive)}catch(t){throw console.error("Error fetching available orchestras:",t),{code:"FETCH_ALL_ORCHESTRAS_FAILED",message:"×©×’×™××” ×‘×˜×¢×™× ×ª ×¨×©×™××ª ×”×ª×–××•×¨×•×ª ×”×–××™× ×•×ª",details:t}}}async getAllAvailableEnsembles(){try{return(await q.request("/ensemble")).filter(l=>l.isActive)}catch(t){throw console.error("Error fetching available ensembles:",t),{code:"FETCH_ALL_ENSEMBLES_FAILED",message:"×©×’×™××” ×‘×˜×¢×™× ×ª ×¨×©×™××ª ×”×”×¨×›×‘×™× ×”×–××™× ×™×",details:t}}}async checkOrchestraEligibility(t,l,i){try{const r=await q.getOrchestra(l),b=i||await q.getStudentDetails(t),p={canEnroll:!0,reasons:[],conflicts:[],instrumentCompatible:!1,hasSpace:!1,meetsRequirements:!1},C=b.instrumentProgress?.map(D=>D.instrumentName)||[];p.instrumentCompatible=r.instruments.some(D=>C.includes(D)),p.instrumentCompatible||(p.canEnroll=!1,p.reasons.push(`×”×›×œ×™ ×©×œ×š (${C.join(", ")}) ×œ× ××ª××™× ×œ×ª×–××•×¨×ª ×–×•`)),r.maxMembers&&r.currentMembers?(p.hasSpace=r.currentMembers<r.maxMembers,p.hasSpace||(p.canEnroll=!1,p.reasons.push("×”×ª×–××•×¨×ª ××œ××” - ××™×Ÿ ××§×•××•×ª ×–××™× ×™×"))):p.hasSpace=!0;const T=await this.detectScheduleConflicts(b,r.rehearsalTimes);return p.conflicts=T,T.length>0&&T.some(f=>f.severity==="overlap")&&(p.canEnroll=!1,p.reasons.push("×™×© ×”×ª× ×’×©×•×ª ×¢× ×”×©×™×¢×•×¨×™× ×”×§×™×™××™× ×©×œ×š")),p.meetsRequirements=!0,p.estimatedCost=r.yearlyFee||0,p}catch(r){throw console.error("Error checking orchestra eligibility:",r),{code:"ELIGIBILITY_CHECK_FAILED",message:"×©×’×™××” ×‘×‘×“×™×§×ª ×–×›××•×ª ×œ×ª×–××•×¨×ª",details:r}}}async checkEnsembleEligibility(t,l,i){try{const r=await q.request(`/ensemble/${l}`),b=i||await q.getStudentDetails(t),p={canEnroll:!0,reasons:[],conflicts:[],instrumentCompatible:!1,hasSpace:!1,meetsRequirements:!1},C=b.instrumentProgress?.map(D=>D.instrumentName)||[];p.instrumentCompatible=r.instruments.some(D=>C.includes(D)),p.instrumentCompatible||(p.canEnroll=!1,p.reasons.push(`×”×›×œ×™ ×©×œ×š (${C.join(", ")}) ×œ× ××ª××™× ×œ×”×¨×›×‘ ×–×”`)),r.maxMembers&&r.currentMembers?(p.hasSpace=r.currentMembers<r.maxMembers,p.hasSpace||(p.canEnroll=!1,p.reasons.push("×”×”×¨×›×‘ ××œ× - ××™×Ÿ ××§×•××•×ª ×–××™× ×™×"))):p.hasSpace=!0;const T=await this.detectScheduleConflicts(b,r.rehearsalTimes);return p.conflicts=T,T.length>0&&T.some(f=>f.severity==="overlap")&&(p.canEnroll=!1,p.reasons.push("×™×© ×”×ª× ×’×©×•×ª ×¢× ×”×©×™×¢×•×¨×™× ×”×§×™×™××™× ×©×œ×š")),p.meetsRequirements=!0,p.estimatedCost=r.yearlyFee||0,p}catch(r){throw console.error("Error checking ensemble eligibility:",r),{code:"ELIGIBILITY_CHECK_FAILED",message:"×©×’×™××” ×‘×‘×“×™×§×ª ×–×›××•×ª ×œ×”×¨×›×‘",details:r}}}async detectScheduleConflicts(t,l){const i=[];try{const r=t.teacherAssignments||[],b={×¨××©×•×Ÿ:0,×©× ×™:1,×©×œ×™×©×™:2,×¨×‘×™×¢×™:3,×—××™×©×™:4,×©×™×©×™:5,×©×‘×ª:6};for(const p of l){const C=b[p.day];for(const T of r){const D=b[T.day];if(C===D){const f=this.timeToMinutes(p.startTime),S=this.timeToMinutes(p.endTime),E=this.timeToMinutes(T.startTime),k=E+(T.duration||45);f<k&&E<S?i.push({type:"lesson",conflictWith:`×©×™×¢×•×¨ ${T.instrumentName||"×›×œ×™ × ×’×™× ×”"} ×¢× ${T.teacherName||"×”××•×¨×”"}`,day:T.day,startTime:T.startTime,endTime:this.minutesToTime(k),severity:"overlap"}):(Math.abs(f-k)<30||Math.abs(E-S)<30)&&i.push({type:"lesson",conflictWith:`×©×™×¢×•×¨ ${T.instrumentName||"×›×œ×™ × ×’×™× ×”"} ×¢× ${T.teacherName||"×”××•×¨×”"}`,day:T.day,startTime:T.startTime,endTime:this.minutesToTime(k),severity:"adjacent"})}}}}catch(r){console.error("Error detecting conflicts:",r)}return i}async addOrchestraEnrollment(t,l){try{const i=await this.checkOrchestraEligibility(t,l);if(!i.canEnroll)throw{code:"ENROLLMENT_NOT_ELIGIBLE",message:`×œ× × ×™×ª×Ÿ ×œ×”×¨×©×: ${i.reasons.join(", ")}`,details:{eligibility:i}};const r=await q.getStudentDetails(t);if(r.orchestraIds?.includes(l))throw{code:"ALREADY_ENROLLED",message:"×”×ª×œ××™×“ ×›×‘×¨ ×¨×©×•× ×œ×ª×–××•×¨×ª ×–×•",details:{orchestraId:l}};const b=[...r.orchestraIds||[],l];await q.request(`/student/${t}`,{method:"PUT",body:JSON.stringify({orchestraIds:b})})}catch(i){throw i.code?i:(console.error("Error adding orchestra enrollment:",i),{code:"ENROLLMENT_FAILED",message:"×©×’×™××” ×‘×¨×™×©×•× ×œ×ª×–××•×¨×ª",details:i})}}async removeOrchestraEnrollment(t,l){try{const i=await q.getStudentDetails(t);if(!i.orchestraIds?.includes(l))throw{code:"NOT_ENROLLED",message:"×”×ª×œ××™×“ ××™× ×• ×¨×©×•× ×œ×ª×–××•×¨×ª ×–×•",details:{orchestraId:l}};const r=i.orchestraIds.filter(b=>b!==l);await q.request(`/student/${t}`,{method:"PUT",body:JSON.stringify({orchestraIds:r})})}catch(i){throw i.code?i:(console.error("Error removing orchestra enrollment:",i),{code:"UNENROLLMENT_FAILED",message:"×©×’×™××” ×‘×‘×™×˜×•×œ ×¨×™×©×•× ××”×ª×–××•×¨×ª",details:i})}}async addEnsembleEnrollment(t,l){try{const i=await this.checkEnsembleEligibility(t,l);if(!i.canEnroll)throw{code:"ENROLLMENT_NOT_ELIGIBLE",message:`×œ× × ×™×ª×Ÿ ×œ×”×¨×©×: ${i.reasons.join(", ")}`,details:{eligibility:i}};const r=await q.getStudentDetails(t);if(r.ensembleIds?.includes(l))throw{code:"ALREADY_ENROLLED",message:"×”×ª×œ××™×“ ×›×‘×¨ ×¨×©×•× ×œ×”×¨×›×‘ ×–×”",details:{ensembleId:l}};const b=[...r.ensembleIds||[],l];await q.request(`/student/${t}`,{method:"PUT",body:JSON.stringify({ensembleIds:b})})}catch(i){throw i.code?i:(console.error("Error adding ensemble enrollment:",i),{code:"ENROLLMENT_FAILED",message:"×©×’×™××” ×‘×¨×™×©×•× ×œ×”×¨×›×‘",details:i})}}async removeEnsembleEnrollment(t,l){try{const i=await q.getStudentDetails(t);if(!i.ensembleIds?.includes(l))throw{code:"NOT_ENROLLED",message:"×”×ª×œ××™×“ ××™× ×• ×¨×©×•× ×œ×”×¨×›×‘ ×–×”",details:{ensembleId:l}};const r=i.ensembleIds.filter(b=>b!==l);await q.request(`/student/${t}`,{method:"PUT",body:JSON.stringify({ensembleIds:r})})}catch(i){throw i.code?i:(console.error("Error removing ensemble enrollment:",i),{code:"UNENROLLMENT_FAILED",message:"×©×’×™××” ×‘×‘×™×˜×•×œ ×¨×™×©×•× ××”×”×¨×›×‘",details:i})}}timeToMinutes(t){const[l,i]=t.split(":").map(Number);return l*60+i}minutesToTime(t){const l=Math.floor(t/60),i=t%60;return`${l.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}}const Se=new Ds,ks=({teacherId:d,timeBlock:t,onSave:l,onCancel:i})=>{const[r,b]=g.useState(()=>t?{day:t.day,startTime:t.startTime,endTime:t.endTime,location:t.location,notes:t.notes||"",isActive:t.isActive,isRecurring:t.recurring?.isRecurring||!0}:{day:"×¨××©×•×Ÿ",startTime:"14:00",endTime:"18:00",location:"×—×“×¨ 25",notes:"",isActive:!0,isRecurring:!0}),[p,C]=g.useState(!1),[T,D]=g.useState(null),f=["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™","×©×‘×ª"],S=(y,v)=>{const[A,W]=y.split(":").map(Number),[x,o]=v.split(":").map(Number),I=A*60+W;return x*60+o-I},E=y=>{const v=Math.floor(y/60),A=y%60;return A>0?`${v} ×©×¢×•×ª ×•-${A} ×“×§×•×ª`:`${v} ×©×¢×•×ª`},k=(y,v)=>{b(A=>({...A,[y]:v})),D(null)},M=()=>{const y=S(r.startTime,r.endTime);return y<=0?(D("×©×¢×ª ×¡×™×•× ×—×™×™×‘×ª ×œ×”×™×•×ª ××—×¨×™ ×©×¢×ª ×”×ª×—×œ×”"),!1):y<30?(D("×–××™× ×•×ª ×—×™×™×‘×ª ×œ×”×™×•×ª ×œ×¤×—×•×ª 30 ×“×§×•×ª"),!1):r.location.trim()?!0:(D("×™×© ×œ×‘×—×•×¨ ××™×§×•×"),!1)},L=async y=>{if(y.preventDefault(),!!M()){C(!0),D(null);try{const v=S(r.startTime,r.endTime),A={day:r.day,startTime:r.startTime,endTime:r.endTime,totalDuration:v,location:r.location,notes:r.notes.trim()||null,isActive:r.isActive,recurring:{isRecurring:r.isRecurring,excludeDates:t?.recurring?.excludeDates||[]}};t?._id?await $.teacherSchedule.updateTimeBlock(d,t._id,A):await $.teacherSchedule.createTimeBlock(d,A),l()}catch(v){console.error("Error saving time block:",v),D("×©×’×™××” ×‘×©××™×¨×ª ×”×–××™× ×•×ª: "+(v.message||"×©×’×™××” ×œ× ×™×“×•×¢×”"))}finally{C(!1)}}},_=S(r.startTime,r.endTime);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:t?"×¢×¨×™×›×ª ×–××™× ×•×ª":"×”×•×¡×¤×ª ×–××™× ×•×ª ×—×“×©×”"}),e.jsx("button",{type:"button",onClick:i,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(he,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:L,className:"p-6 space-y-6",children:[T&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700 text-sm",children:T})}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"×™×•× ×‘×©×‘×•×¢ *"]}),e.jsx("select",{value:r.day,onChange:y=>k("day",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900",required:!0,children:f.map(y=>e.jsx("option",{value:y,children:y},y))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"×©×¢×ª ×”×ª×—×œ×” *"]}),e.jsx("input",{type:"time",value:r.startTime,onChange:y=>k("startTime",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"×©×¢×ª ×¡×™×•× *"}),e.jsx("input",{type:"time",value:r.endTime,onChange:y=>k("endTime",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900",required:!0})]})]}),_>0&&e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center text-blue-700",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{className:"font-medium",children:["××©×š ×–××Ÿ: ",E(_)]})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ae,{className:"w-4 h-4 mr-2"}),"××™×§×•× *"]}),e.jsx("select",{value:r.location,onChange:y=>k("location",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-gray-900",required:!0,children:Ee.map(y=>e.jsx("option",{value:y,children:y},y))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"×”×¢×¨×•×ª"}),e.jsx("textarea",{value:r.notes,onChange:y=>k("notes",y.target.value),placeholder:"×”×¢×¨×•×ª ××•×¤×¦×™×•× ×œ×™×•×ª...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 resize-none"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.isRecurring,onChange:y=>k("isRecurring",y.target.checked),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-gray-700 mr-3",children:"×—×•×–×¨ ×©×‘×•×¢×™×ª"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.isActive,onChange:y=>k("isActive",y.target.checked),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-gray-700 mr-3",children:"×¤×¢×™×œ"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"submit",disabled:p,className:"flex-1 flex items-center justify-center px-4 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"×©×•××¨..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),t?"×¢×“×›×Ÿ":"×¦×•×¨"," ×–××™× ×•×ª"]})}),e.jsx("button",{type:"button",onClick:i,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 font-medium",children:"×‘×™×˜×•×œ"})]})]})]})})},As=({teacher:d,teacherId:t})=>{const[l,i]=g.useState(null),[r,b]=g.useState(!1),[p,C]=g.useState([]),[T,D]=g.useState([]),[f,S]=g.useState([]),[E,k]=g.useState(!1),[M,L]=g.useState(!1),[_,y]=g.useState(!1),[v,A]=g.useState(d),[W,x]=g.useState(null);g.useEffect(()=>{A(d)},[d]);const o=(s,c)=>{if(!s||!c)return 0;const[u,m]=s.split(":").map(Number),[n,a]=c.split(":").map(Number),j=u*60+m;return n*60+a-j};g.useEffect(()=>{(async()=>{if(d.conducting){k(!0);try{const c=(d.conducting.orchestraIds||[]).map(async w=>{try{const N=await Se.getCurrentOrchestraEnrollments([w]);return N[0]?{_id:N[0]._id,name:N[0].name,type:"orchestra",rehearsalTimes:N[0].rehearsalTimes||[],location:"××•×œ× ×”×ª×–××•×¨×ª",participants:N[0].currentMembers||0}:null}catch(N){return console.warn(`Failed to load orchestra ${w}:`,N),null}}),u=(d.conducting.ensemblesIds||[]).map(async w=>{try{const N=await Se.getCurrentEnsembleEnrollments([w]);return N[0]?{_id:N[0]._id,name:N[0].name,type:"ensemble",rehearsalTimes:N[0].rehearsalTimes||[],location:"×—×“×¨ ×”×× ×¡××‘×œ",participants:N[0].currentMembers||0}:null}catch(N){return console.warn(`Failed to load ensemble ${w}:`,N),null}}),[m,n]=await Promise.all([Promise.allSettled(c),Promise.allSettled(u)]),a=m.filter(w=>w.status==="fulfilled"&&w.value!==null).map(w=>w.value),j=n.filter(w=>w.status==="fulfilled"&&w.value!==null).map(w=>w.value),O=a.flatMap(w=>w.rehearsalTimes.map(N=>({_id:`${w._id}-${N.day}-${N.startTime}`,name:w.name,day:N.day,startTime:N.startTime,endTime:N.endTime,location:N.location||w.location,participants:w.participants,type:"orchestra"}))),F=j.flatMap(w=>w.rehearsalTimes.map(N=>({_id:`${w._id}-${N.day}-${N.startTime}`,name:w.name,day:N.day,startTime:N.startTime,endTime:N.endTime,location:N.location||w.location,participants:w.participants,type:"ensemble"})));C(O),D(F)}catch(c){console.error("Failed to load conducting activities:",c)}finally{k(!1)}}})()},[d.conducting]),g.useEffect(()=>{(async()=>{if(t)try{console.log("ğŸ”„ Loading teacher lessons for ID:",t);const c=await $.teachers.getTeacherLessons(t);console.log("âœ… Teacher lessons loaded from API:",c);let u=c?.lessons||c?.data?.lessons||[];if(console.log(`ğŸ“š API returned ${u.length} lessons`),u.length===0&&v.teaching?.schedule){console.log("ğŸ”„ API returned no lessons, using teacher schedule data as fallback");const m=v.teaching.schedule.filter(n=>n.studentId&&(!n.status||n.status==="active")).map(n=>({_id:n._id,studentId:n.studentId,studentName:n.studentName,day:n.day,startTime:n.startTime,time:n.startTime,endTime:n.endTime,duration:n.duration,location:n.location,instrumentName:n.instrument,lessonType:"individual",isRecurring:n.isRecurring,notes:n.notes}));console.log(`ğŸ“š Found ${m.length} lessons in teacher.teaching.schedule`),v.teaching?.timeBlocks&&(v.teaching.timeBlocks.forEach(n=>{n.assignedLessons&&n.assignedLessons.length>0&&n.assignedLessons.forEach(a=>{m.some(O=>O.studentId===a.studentId&&O.day===n.day&&O.startTime===a.startTime)||m.push({_id:`${n._id}-${a.studentId}`,studentId:a.studentId,studentName:a.studentName,day:n.day,startTime:a.startTime,time:a.startTime,endTime:a.endTime,duration:a.duration,location:n.location,lessonType:"individual"})})}),console.log(`ğŸ“š Total lessons after checking timeBlocks: ${m.length}`)),u=m}S(u),console.log(`ğŸ“š Final set ${u.length} lessons for teacher`)}catch(c){if(console.error("âŒ Failed to load teacher lessons:",c),v.teaching?.schedule){console.log("ğŸ”„ Using teacher schedule data after API error");const u=v.teaching.schedule.filter(m=>m.studentId&&(!m.status||m.status==="active")).map(m=>({_id:m._id,studentId:m.studentId,studentName:m.studentName,day:m.day,startTime:m.startTime,time:m.startTime,endTime:m.endTime,duration:m.duration,location:m.location,instrumentName:m.instrument,lessonType:"individual"}));S(u),console.log(`ğŸ“š Set ${u.length} fallback lessons`)}else S([])}})()},[t,v.teaching?.schedule,v.teaching?.timeBlocks]);const I=["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™","×©×‘×ª"],H=async()=>{try{const s=await $.teachers.getTeacher(t);A(s)}catch(s){console.error("Failed to refresh teacher data:",s)}},U=g.useMemo(()=>{const s=[];if(v.teaching?.timeBlocks){const u=v.teaching.timeBlocks.map(m=>({...m,totalDuration:o(m.startTime,m.endTime)}));s.push(...u)}v.teaching?.schedule&&v.teaching.schedule.forEach(u=>{u.studentId||s.push({_id:u._id,day:u.day,startTime:u.startTime,endTime:u.endTime,totalDuration:o(u.startTime,u.endTime),location:u.location,notes:u.notes,isActive:u.isAvailable!==!1,assignedLessons:[],isFromSchedule:!0})});const c=u=>{const m=I.indexOf(u);return m===-1?999:m};return s.sort((u,m)=>{const n=c(u.day)-c(m.day);if(n!==0)return n;const a=u.startTime||"00:00",j=m.startTime||"00:00";return a.localeCompare(j)})},[v.teaching?.timeBlocks,v.teaching?.schedule]);I.reduce((s,c)=>(s[c]=U.filter(u=>u.day===c)||[],s),{});const K=()=>U.reduce((s,c)=>s+(c.totalDuration||0),0)/60||0,X=()=>{const s=new Set;return v.teaching?.schedule?.forEach(c=>{c.studentId&&s.add(c.studentId)}),s.size},Q=async s=>{try{if(console.log("ğŸ”„ Updating lesson via student record:",s),console.log("ğŸ†” Student ID:",s.studentId),console.log("ğŸ‘¨â€ğŸ« Teacher ID:",s.teacherId||t),console.log("ğŸ“ Update data:",{day:s.day,startTime:s.startTime,endTime:s.endTime,duration:s.duration}),!s.studentId)throw new Error("Student ID is missing");const c=await $.students.getStudentById(s.studentId);if(console.log("ğŸ“‹ Current student data loaded:",c.personalInfo?.fullName),!c.teacherAssignments||c.teacherAssignments.length===0)throw new Error("No teacher assignments found for this student");const u=s.teacherId||t,m=c.teacherAssignments.findIndex(N=>N.teacherId===u&&N.isActive);if(m===-1)throw new Error(`No active assignment found for teacher ${u}`);console.log(`ğŸ¯ Found teacher assignment at index ${m}`);const n=[...c.teacherAssignments],a=n[m],j=(N,B)=>{const[R,z]=N.split(":").map(Number),P=R*60+z+B,oe=Math.floor(P/60),te=P%60;return`${oe.toString().padStart(2,"0")}:${te.toString().padStart(2,"0")}`};n[m]={...a,day:s.day,time:s.startTime,duration:s.duration,scheduleInfo:{...a.scheduleInfo,day:s.day,startTime:s.startTime,endTime:j(s.startTime,s.duration),duration:s.duration,updatedAt:new Date().toISOString()},updatedAt:new Date().toISOString()},console.log("ğŸ“¤ Updating student record with new assignment:",n[m]);const O=await $.students.updateStudent(s.studentId,{teacherAssignments:n});console.log("âœ… Student updated successfully:",O.personalInfo?.fullName);const F=await $.teachers.getTeacherLessons(t),w=F?.lessons||F?.data?.lessons||[];S(w),console.log("âœ… Teacher lessons refreshed - new count:",w.length),ce.success("×”×©×™×¢×•×¨ ×¢×•×“×›×Ÿ ×‘×”×¦×œ×—×”",{duration:3e3,position:"top-center"})}catch(c){throw console.error("âŒ Failed to update lesson:",c),console.error("âŒ Error details:",c.message),c}},le=async s=>{try{if(console.log("ğŸ—‘ï¸ Deleting lesson:",s),console.log("ğŸ†” Student ID:",s.studentId),console.log("ğŸ‘¨â€ğŸ« Teacher ID:",s.teacherId||t),!s.studentId)throw new Error("Student ID is missing");const c=await $.students.getStudentById(s.studentId);if(console.log("ğŸ“‹ Current student data loaded:",c.personalInfo?.fullName),!c.teacherAssignments||c.teacherAssignments.length===0)throw new Error("No teacher assignments found for this student");const u=s.teacherId||t,m=c.teacherAssignments.findIndex(F=>F.teacherId===u&&F.isActive);if(m===-1)throw new Error(`No active assignment found for teacher ${u}`);console.log(`ğŸ¯ Found teacher assignment at index ${m}`);const n=[...c.teacherAssignments];n[m]={...n[m],isActive:!1,endDate:new Date().toISOString(),updatedAt:new Date().toISOString()},console.log("ğŸ“¤ Deactivating student teacher assignment");const a=await $.students.updateStudent(s.studentId,{teacherAssignments:n});if(console.log("âœ… Student assignment deactivated successfully:",a.personalInfo?.fullName),v.teaching?.schedule){const F=v.teaching.schedule.filter(w=>w.studentId!==s.studentId);F.length!==v.teaching.schedule.length&&(console.log("ğŸ“¤ Removing lesson from teacher schedule"),await $.teachers.updateTeacher(t,{teaching:{...v.teaching,schedule:F}}))}const j=await $.teachers.getTeacherLessons(t),O=j?.lessons||j?.data?.lessons||[];S(O),await H(),console.log("âœ… Lesson deleted - refreshed lessons count:",O.length),ce.success("×”×©×™×¢×•×¨ × ××—×§ ×‘×”×¦×œ×—×”",{duration:3e3,position:"top-center"})}catch(c){throw console.error("âŒ Failed to delete lesson:",c),console.error("âŒ Error details:",c.message),ce.error("×©×’×™××” ×‘××—×™×§×ª ×”×©×™×¢×•×¨. ×× × × ×¡×” ×©×•×‘.",{duration:4e3,position:"top-center"}),c}},G=p.length+T.length,ie=K(),se=U.length||0,h=X();return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-end items-start",children:[E&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600 mr-4",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),"×˜×•×¢×Ÿ ×¤×¢×™×œ×•×™×•×ª ×”× ×™×¦×•×—..."]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-600",children:Math.round(ie)}),e.jsx("div",{className:"text-gray-600",children:"×©×¢×•×ª ×©×‘×•×¢×™×•×ª"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:se}),e.jsx("div",{className:"text-gray-600",children:"×™××™ ×œ×™××•×“"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:h}),e.jsx("div",{className:"text-gray-600",children:"×ª×œ××™×“×™×"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:G}),e.jsx("div",{className:"text-gray-600",children:"×”×¨×›×‘×™×"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>L(!1),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${M?"bg-white text-gray-600 hover:bg-gray-100":"bg-primary-500 text-white"}`,children:"×œ×•×— ×–×× ×™× ×©×‘×•×¢×™"}),e.jsx("button",{onClick:()=>L(!0),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${M?"bg-primary-500 text-white":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"× ×™×”×•×œ ×™××™ ×œ×™××•×“"})]}),G>0&&e.jsxs("div",{className:"text-sm text-gray-600",children:["×× ×¦×— ×¢×œ ",G," ×”×¨×›×‘×™×"]})]}),M?e.jsxs("div",{className:"space-y-6",children:[U.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:U.map((s,c)=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:s.day})]}),s.isActive&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full font-medium",children:"×¤×¢×™×œ"})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(Z,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"font-medium",children:[s.startTime," - ",s.endTime]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx("span",{className:"text-sm",children:"××©×š:"}),e.jsxs("span",{className:"font-medium text-blue-600",children:[Math.floor(s.totalDuration/60)," ×©×¢×•×ª",s.totalDuration%60!==0&&` ×•-${s.totalDuration%60} ×“×§×•×ª`]})]}),s.location&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ae,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:s.location})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Y,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-sm",children:[s.assignedLessons?.length||0," ×©×™×¢×•×¨×™× ××ª×•×›× × ×™×"]})]})]}),s.notes&&e.jsx("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-600",children:s.notes})}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-100",children:[e.jsxs("button",{onClick:()=>i(s),className:"flex-1 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors font-medium",children:[e.jsx(ne,{className:"w-4 h-4 inline-block ml-1"}),"×¢×¨×•×š"]}),e.jsxs("button",{onClick:()=>x({timeBlock:s}),disabled:_,className:"flex-1 px-3 py-2 text-sm bg-red-50 text-red-700 rounded-lg hover:bg-red-100 transition-colors font-medium disabled:opacity-50",children:[e.jsx(ue,{className:"w-4 h-4 inline-block ml-1"}),_?"××•×—×§...":"××—×§"]})]})]},s._id||c))}):e.jsxs("div",{className:"bg-white rounded-xl border-2 border-dashed border-gray-200 p-12 text-center",children:[e.jsx(ee,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"××™×Ÿ ×™××™ ×œ×™××•×“ ××•×’×“×¨×™×"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"×˜×¨× ×”×•×’×“×¨×• ×™××™ ×œ×™××•×“ ×¢×‘×•×¨ ××•×¨×” ×–×”. ×”×’×“×¨ ×™××™ ×œ×™××•×“ ×›×“×™ ×œ××¤×©×¨ ×ª×–××•×Ÿ ×©×™×¢×•×¨×™×."}),e.jsx("button",{onClick:()=>b(!0),className:"px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-medium",children:"×”×•×¡×£ ×™×•× ×œ×™××•×“ ×¨××©×•×Ÿ"})]}),U.length>0&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-medium shadow-sm",children:[e.jsx(xe,{className:"w-5 h-5"}),"×”×•×¡×£ ×™×•× ×œ×™××•×“ ×—×“×©"]})})]}):e.jsx(Cs,{teacher:v,timeBlocks:U,lessons:f,orchestraActivities:p,className:"",showNavigation:!0,onLessonUpdate:Q,onLessonDelete:le}),l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["×¢×¨×•×š ×™×•× ×œ×™××•×“ - ",l.day]}),e.jsx("button",{onClick:()=>i(null),className:"text-gray-400 hover:text-gray-600 p-1",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×–××Ÿ ×”×ª×—×œ×”"}),e.jsx("input",{type:"time",defaultValue:l.startTime,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×–××Ÿ ×¡×™×•×"}),e.jsx("input",{type:"time",defaultValue:l.endTime,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"××™×§×•×"}),e.jsxs("select",{defaultValue:l.location||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white",children:[e.jsx("option",{value:"",children:"×‘×—×¨ ××™×§×•×..."}),Ee.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×”×¢×¨×•×ª"}),e.jsx("textarea",{defaultValue:l.notes,placeholder:"×”×¢×¨×•×ª × ×•×¡×¤×•×ª ×¢×œ ×™×•× ×”×œ×™××•×“...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"isActive",defaultChecked:l.isActive,className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsx("label",{htmlFor:"isActive",className:"text-sm font-medium text-gray-700",children:"×™×•× ×œ×™××•×“ ×¤×¢×™×œ (×–××™×Ÿ ×œ×§×‘×™×¢×ª ×©×™×¢×•×¨×™×)"})]}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-medium disabled:opacity-50",disabled:_,onClick:async s=>{s.preventDefault();const c=s.target.closest("form");new FormData(c);const u=c.querySelectorAll('input[type="time"]'),m=u[0].value,n=u[1].value,a=c.querySelector("select").value,j=c.querySelector("textarea").value,O=c.querySelector('input[type="checkbox"]').checked,w=((N,B)=>{const[R,z]=N.split(":").map(Number),[P,oe]=B.split(":").map(Number),te=R*60+z;return P*60+oe-te})(m,n);try{if(y(!0),l.isFromSchedule){const N=v.teaching.schedule.map(P=>P._id===l._id?{_id:P._id,day:P.day,startTime:m,endTime:n,duration:w,location:a,notes:j||null,isAvailable:O,studentId:P.studentId,recurring:P.recurring}:P);console.log("ğŸ”„ Simplified update approach"),console.log("ğŸ”„ Updated schedule entry:",N.find(P=>P._id===l._id));const B=localStorage.getItem("authToken")||sessionStorage.getItem("authToken");if(!B)throw new Error("No authentication token found");console.log("ğŸ”‘ Using token:",B?"Token exists":"No token found"),console.log("ğŸ“Š Duration calculated:",w,"minutes"),console.log("ğŸ“ Time range:",m,"-",n);const R=await fetch(`http://localhost:3001/api/teacher/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${B}`},body:JSON.stringify({teaching:{...v.teaching,schedule:N}})});if(!R.ok){const P=await R.text();throw console.error("âŒ Server response:",P),new Error(`HTTP ${R.status}: ${P}`)}const z=await R.json();console.log("âœ… Update successful:",z)}else await $.teacherSchedule.updateTimeBlock(t,l._id,{startTime:m,endTime:n,totalDuration:w,location:a,notes:j,isActive:O});await H(),i(null),console.log("âœ… Successfully updated teaching day")}catch(N){console.error("âŒ Failed to update teaching day:",N),console.error("Error details:",N.response?.data||N.message),ce.error("×©×’×™××” ×‘×¢×“×›×•×Ÿ ×™×•× ×”×œ×™××•×“. ×× × × ×¡×” ×©×•×‘.",{duration:4e3,position:"top-center",style:{background:"#FEE2E2",color:"#991B1B",border:"1px solid #FCA5A5",padding:"16px",fontSize:"14px",fontFamily:"Reisinger-Yonatan, sans-serif"}})}finally{y(!1)}},children:_?"×©×•××¨...":"×©××•×¨ ×©×™× ×•×™×™×"}),e.jsx("button",{type:"button",onClick:()=>i(null),className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"×‘×™×˜×•×œ"})]})]})]})}),!M&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"××§×¨×"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-100 border border-blue-300 rounded"}),e.jsx("span",{className:"text-gray-700",children:"×©×™×¢×•×¨×™× ×¤×¨×˜×™×™×"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-purple-100 border border-purple-300 rounded"}),e.jsx("span",{className:"text-gray-700",children:"×ª×–××•×¨×•×ª"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-100 border border-green-300 rounded"}),e.jsx("span",{className:"text-gray-700",children:"×× ×¡××‘×œ×™×"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-100 border border-gray-300 rounded"}),e.jsx("span",{className:"text-gray-700",children:"×–××Ÿ ×¤× ×•×™"})]})]})]}),W&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 p-6",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 rounded-full",children:e.jsx(J,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 text-center mb-2",children:"××—×™×§×ª ×™×•× ×œ×™××•×“"}),e.jsxs("p",{className:"text-gray-600 text-center mb-6",children:["×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×™×•× ×”×œ×™××•×“ ×‘×™×•× ",W.timeBlock.day,"?"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>x(null),className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"×‘×™×˜×•×œ"}),e.jsx("button",{onClick:async()=>{const s=W.timeBlock;x(null);try{if(y(!0),s.isFromSchedule){const c=v.teaching.schedule.filter(m=>m._id!==s._id),u={teaching:{...v.teaching,schedule:c}};console.log("ğŸ—‘ï¸ Deleting teaching day with data:",u),await $.teachers.updateTeacher(t,u)}else await $.teacherSchedule.deleteTimeBlock(t,s._id);await H(),console.log("âœ… Successfully deleted teaching day:",s.day)}catch(c){console.error("âŒ Failed to delete teaching day:",c),console.error("Error details:",c.response?.data||c.message),ce.error("×©×’×™××” ×‘××—×™×§×ª ×™×•× ×”×œ×™××•×“. ×× × × ×¡×” ×©×•×‘.",{duration:4e3,position:"top-center",style:{background:"#FEE2E2",color:"#991B1B",border:"1px solid #FCA5A5",padding:"16px",fontSize:"14px",fontFamily:"Reisinger-Yonatan, sans-serif"}})}finally{y(!1)}},disabled:_,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium disabled:opacity-50",children:_?"××•×—×§...":"××—×§"})]})]})}),r&&e.jsx(ks,{teacherId:t,timeBlock:null,onSave:async()=>{await H(),b(!1)},onCancel:()=>b(!1)})]})},Ms=({teacher:d,teacherId:t})=>{const[l,i]=g.useState([]),[r,b]=g.useState([]),[p,C]=g.useState(!0),[T,D]=g.useState(!1),[f,S]=g.useState(!1),[E,k]=g.useState({name:"",description:""}),[M,L]=g.useState({name:"",description:"",type:""});g.useEffect(()=>{(async()=>{try{if(C(!0),d.conducting?.orchestraIds?.length>0){const o=d.conducting.orchestraIds.map(I=>$.orchestras?.getOrchestraById(I));if(o.length>0)try{const I=await Promise.all(o);i(I.filter(Boolean))}catch(I){console.warn("Error fetching orchestras:",I),i([])}}if(d.conducting?.ensemblesIds?.length>0){const o=d.conducting.ensemblesIds.map(I=>$.ensembles?.getEnsembleById(I));if(o.length>0)try{const I=await Promise.all(o);b(I.filter(Boolean))}catch(I){console.warn("Error fetching ensembles:",I),b([])}}}catch(o){console.error("Error fetching conducting data:",o)}finally{C(!1)}})()},[d.conducting]);const _=async()=>{if(E.name.trim())try{const x={...E,conductorId:t,memberIds:[],isActive:!0,createdAt:new Date};console.log("Creating orchestra:",x);const o={_id:`temp-${Date.now()}`,...x};i(I=>[...I,o]),k({name:"",description:""}),D(!1)}catch(x){console.error("Error creating orchestra:",x)}},y=async()=>{if(M.name.trim())try{const x={...M,conductorId:t,memberIds:[],isActive:!0,createdAt:new Date};console.log("Creating ensemble:",x);const o={_id:`temp-${Date.now()}`,...x};b(I=>[...I,o]),L({name:"",description:"",type:""}),S(!1)}catch(x){console.error("Error creating ensemble:",x)}},v=async x=>{if(confirm("×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×”×ª×–××•×¨×ª?"))try{console.log("Deleting orchestra:",x),i(o=>o.filter(I=>I._id!==x))}catch(o){console.error("Error deleting orchestra:",o)}},A=async x=>{if(confirm("×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×”×× ×¡××‘×œ?"))try{console.log("Deleting ensemble:",x),b(o=>o.filter(I=>I._id!==x))}catch(o){console.error("Error deleting ensemble:",o)}};if(p)return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse w-1/3"}),e.jsx("div",{className:"space-y-3",children:[1,2].map(x=>e.jsx("div",{className:"h-24 bg-gray-200 rounded animate-pulse"},x))})]});const W=l.reduce((x,o)=>x+(o.memberIds?.length||0),0)+r.reduce((x,o)=>x+(o.memberIds?.length||0),0);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:l.length}),e.jsx("div",{className:"text-gray-600",children:"×ª×–××•×¨×•×ª"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.length}),e.jsx("div",{className:"text-gray-600",children:"×× ×¡××‘×œ×™×"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:W}),e.jsx("div",{className:"text-gray-600",children:"×¡×š ×—×‘×¨×™×"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"×ª×–××•×¨×•×ª"}),e.jsxs("button",{onClick:()=>D(!0),className:"flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:[e.jsx(xe,{className:"w-4 h-4"}),"×¦×•×¨ ×ª×–××•×¨×ª"]})]}),l.length===0?e.jsxs("div",{className:"text-center py-8 bg-purple-50 rounded-lg",children:[e.jsx(pe,{className:"w-12 h-12 text-purple-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"××™×Ÿ ×ª×–××•×¨×•×ª"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"×¢×“×™×™×Ÿ ×œ× × ×•×¦×¨×• ×ª×–××•×¨×•×ª ×ª×—×ª × ×™×¦×•×—×• ×©×œ ×”××•×¨×”"}),e.jsx("button",{onClick:()=>D(!0),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:"×¦×•×¨ ×ª×–××•×¨×ª ×¨××©×•× ×”"})]}):e.jsx("div",{className:"grid gap-4",children:l.map(x=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:x.name}),x.description&&e.jsx("p",{className:"text-gray-600 mb-3",children:x.description}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"w-4 h-4"}),x.memberIds?.length||0," ×—×‘×¨×™×"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"w-4 h-4"}),x.rehearsalSchedule?.length||0," ×—×–×¨×•×ª"]}),e.jsx("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${x.isActive!==!1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:x.isActive!==!1?"×¤×¢×™×œ":"×œ× ×¤×¢×™×œ"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-2 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>v(x._id),className:"px-3 py-2 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:e.jsx(ue,{className:"w-4 h-4"})})]})]})},x._id))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"×× ×¡××‘×œ×™×"}),e.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[e.jsx(xe,{className:"w-4 h-4"}),"×¦×•×¨ ×× ×¡××‘×œ"]})]}),r.length===0?e.jsxs("div",{className:"text-center py-8 bg-blue-50 rounded-lg",children:[e.jsx(Ce,{className:"w-12 h-12 text-blue-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"××™×Ÿ ×× ×¡××‘×œ×™×"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"×¢×“×™×™×Ÿ ×œ× × ×•×¦×¨×• ×× ×¡××‘×œ×™× ×ª×—×ª × ×™×¦×•×—×• ×©×œ ×”××•×¨×”"}),e.jsx("button",{onClick:()=>S(!0),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"×¦×•×¨ ×× ×¡××‘×œ ×¨××©×•×Ÿ"})]}):e.jsx("div",{className:"grid gap-4",children:r.map(x=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:x.name}),x.description&&e.jsx("p",{className:"text-gray-600 mb-3",children:x.description}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"w-4 h-4"}),x.memberIds?.length||0," ×—×‘×¨×™×"]}),x.type&&e.jsx("div",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs",children:x.type}),e.jsx("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${x.isActive!==!1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:x.isActive!==!1?"×¤×¢×™×œ":"×œ× ×¤×¢×™×œ"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-2 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>A(x._id),className:"px-3 py-2 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:e.jsx(ue,{className:"w-4 h-4"})})]})]})},x._id))})]}),T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"×¦×•×¨ ×ª×–××•×¨×ª ×—×“×©×”"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©× ×”×ª×–××•×¨×ª"}),e.jsx("input",{type:"text",value:E.name,onChange:x=>k({...E,name:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"×”×›× ×¡ ×©× ×ª×–××•×¨×ª..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª×™××•×¨"}),e.jsx("textarea",{value:E.description,onChange:x=>k({...E,description:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"×ª×™××•×¨ ×”×ª×–××•×¨×ª...",rows:3})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:_,disabled:!E.name.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors disabled:bg-gray-300",children:"×¦×•×¨ ×ª×–××•×¨×ª"}),e.jsx("button",{onClick:()=>{D(!1),k({name:"",description:""})},className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"×‘×˜×œ"})]})]})]})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"×¦×•×¨ ×× ×¡××‘×œ ×—×“×©"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×©× ×”×× ×¡××‘×œ"}),e.jsx("input",{type:"text",value:M.name,onChange:x=>L({...M,name:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"×”×›× ×¡ ×©× ×× ×¡××‘×œ..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×¡×•×’ ×”×× ×¡××‘×œ"}),e.jsxs("select",{value:M.type,onChange:x=>L({...M,type:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×¡×•×’..."}),e.jsx("option",{value:"×§×œ××¡×™",children:"×§×œ××¡×™"}),e.jsx("option",{value:"×’'××–",children:"×’'××–"}),e.jsx("option",{value:"×›×œ×™ × ×©×™×¤×”",children:"×›×œ×™ × ×©×™×¤×”"}),e.jsx("option",{value:"×›×œ×™ ××™×ª×¨",children:"×›×œ×™ ××™×ª×¨"}),e.jsx("option",{value:"××¢×•×¨×‘",children:"××¢×•×¨×‘"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"×ª×™××•×¨"}),e.jsx("textarea",{value:M.description,onChange:x=>L({...M,description:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"×ª×™××•×¨ ×”×× ×¡××‘×œ...",rows:3})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:y,disabled:!M.name.trim(),className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-300",children:"×¦×•×¨ ×× ×¡××‘×œ"}),e.jsx("button",{onClick:()=>{S(!1),L({name:"",description:"",type:""})},className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"×‘×˜×œ"})]})]})]})})]})},$s=({activeTab:d,teacherId:t,teacher:l,isLoading:i})=>{if(i||!l)return e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse w-1/3"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-2/3"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-1/2"})]})]});switch(d){case"personal":return e.jsx(Ke,{teacher:l,teacherId:t});case"students":return e.jsx(Qe,{teacher:l,teacherId:t});case"schedule":return e.jsx(As,{teacher:l,teacherId:t});case"conducting":return e.jsx(Ms,{teacher:l,teacherId:t});default:return e.jsx("div",{className:"p-6 text-center text-gray-500",children:e.jsx("p",{children:"×ª×•×›×Ÿ ×”×›×¨×˜×™×¡×™×™×” ×œ× × ××¦×"})})}},Hs=()=>{const{teacherId:d}=Ae(),t=Me(),[l,i]=g.useState("personal"),[r,b]=g.useState(null),[p,C]=g.useState(!0),[T,D]=g.useState(null);if(!d||d.trim()==="")return e.jsx($e,{to:"/teachers",replace:!0});const f=g.useCallback(async()=>{if(d)try{C(!0),D(null),console.log("ğŸ”„ Fetching teacher data for ID:",d);const S=await $.teachers.getTeacherById(d);console.log("âœ… Teacher data loaded:",S?.personalInfo?.fullName),b(S)}catch(S){console.error("âŒ Error fetching teacher:",S),D({code:S.status===404?"NOT_FOUND":S.status===401?"UNAUTHORIZED":S.status===403?"FORBIDDEN":"SERVER_ERROR",message:S.message||"×©×’×™××” ×‘×˜×¢×™× ×ª × ×ª×•× ×™ ×”××•×¨×”"})}finally{C(!1)}},[d]);return g.useEffect(()=>{f()},[f]),T?.code==="NOT_FOUND"?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-96 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ğŸ”"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"××•×¨×” ×œ× × ××¦×"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"×”××•×¨×” ×©×‘×™×§×©×ª ×œ× × ××¦× ×‘××¢×¨×›×ª ××• ×©××™×Ÿ ×œ×š ×”×¨×©××” ×œ×¦×¤×•×ª ×‘×•"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>t("/teachers"),className:"flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(ge,{className:"w-4 h-4 ml-2"}),"×—×–×•×¨ ×œ×¨×©×™××ª ××•×¨×™×"]}),e.jsxs("button",{onClick:()=>window.location.reload(),className:"flex items-center px-4 py-2 border border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(ye,{className:"w-4 h-4 ml-2"}),"× ×¡×” ×©×•×‘"]})]})]}):T?.code==="UNAUTHORIZED"||T?.code==="FORBIDDEN"?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-96 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ğŸ”’"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"××™×Ÿ ×”×¨×©××”"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"××™×Ÿ ×œ×š ×”×¨×©××” ×œ×¦×¤×•×ª ×‘×¤×¨×˜×™ ××•×¨×” ×–×”"}),e.jsxs("button",{onClick:()=>t("/teachers"),className:"flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(ge,{className:"w-4 h-4 ml-2"}),"×—×–×•×¨ ×œ×¨×©×™××ª ××•×¨×™×"]})]}):T&&!["NOT_FOUND","UNAUTHORIZED","FORBIDDEN"].includes(T.code)?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-96 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"âš ï¸"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"×©×’×™××” ×‘×˜×¢×™× ×ª ×”× ×ª×•× ×™×"}),e.jsx("p",{className:"text-gray-600 mb-6",children:T.message}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>window.location.reload(),className:"flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[e.jsx(ye,{className:"w-4 h-4 ml-2"}),"× ×¡×” ×©×•×‘"]}),e.jsxs("button",{onClick:()=>t("/teachers"),className:"flex items-center px-4 py-2 border border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(ge,{className:"w-4 h-4 ml-2"}),"×—×–×•×¨ ×œ×¨×©×™××ª ××•×¨×™×"]})]})]}):p?e.jsx("div",{className:"space-y-6 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-600",children:"×˜×•×¢×Ÿ ×¤×¨×˜×™ ××•×¨×”..."})]})}):e.jsxs("div",{className:"space-y-6 bg-white min-h-screen teacher-details-container teacher-content-area",children:[e.jsxs("nav",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("button",{onClick:()=>t("/teachers"),className:"hover:text-primary-600 transition-colors",children:"××•×¨×™×"}),e.jsx("span",{children:">"}),e.jsx("span",{className:"text-gray-900",children:r?.personalInfo?.fullName||"×¤×¨×˜×™ ××•×¨×”"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xl text-primary-600",children:"ğŸ‘¨â€ğŸ«"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r?.personalInfo?.fullName||"×˜×•×¢×Ÿ..."}),e.jsxs("p",{className:"text-gray-600",children:[r?.professionalInfo?.instrument||"×œ×œ× ×›×œ×™"," | ",r?.roles?.join(", ")||"××•×¨×”"]})]}),r?.conducting?.orchestraIds?.length>0&&e.jsx("div",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:"×× ×¦×—"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 w-full overflow-hidden",children:[e.jsx(Ye,{activeTab:l,onTabChange:i,tabs:[{id:"personal",label:"××™×“×¢ ××™×©×™",component:()=>null},{id:"students",label:"× ×™×”×•×œ ×ª×œ××™×“×™×",component:()=>null},{id:"schedule",label:"×œ×•×— ×–×× ×™×",component:()=>null},...r?.conducting?.orchestraIds?.length>0||r?.conducting?.ensemblesIds?.length>0||r?.roles?.includes("×× ×¦×—")?[{id:"conducting",label:"× ×™×¦×•×—",component:()=>null}]:[]]}),e.jsx($s,{activeTab:l,teacherId:d,teacher:r,isLoading:p})]})]})};export{Hs as default};
